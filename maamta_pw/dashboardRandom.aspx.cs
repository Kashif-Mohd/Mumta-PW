using MySql.Data.MySqlClient;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Globalization;
using System.Web;
using System.Text;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.DataVisualization.Charting;
using System.Drawing;

namespace maamta_pw
{
    public partial class dashboardRandom : System.Web.UI.Page
    {


        string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;

        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                Session["WebForm"] = "DashboardRandom";



                txtCalndrDate.Text = DateTime.Now.ToString("dd-MM-yyyy");
                txtCalndrDate1.Text = DateTime.Now.ToString("dd-MM-yyyy");

                txtCalndrDate.Attributes.Add("readonly", "readonly");
                txtCalndrDate1.Attributes.Add("readonly", "readonly");

                TotalEnrollment();
                ShowData();
                LoadChartAllSite();
            }
        }


        public void showalert(string message)
        {
            string script = @"alert('" + message + "');";
            ScriptManager.RegisterStartupScript(this, this.GetType(), "Alert", script, true);
        }









        private void LoadChartAllSite()
        {
            try
            {
                string query = string.Format("select concat(Date_Format(str_to_date(pw_crf_3a_2, '%d-%m-%Y'),'%b'),'-',Date_Format(str_to_date(pw_crf_3a_2, '%d-%m-%Y'),'%y')) as Year, count(*) as enrollment	   from form_crf_3a group by Year(str_to_date(pw_crf_3a_2, '%d-%m-%Y')),Month(str_to_date(pw_crf_3a_2, '%d-%m-%Y'))");
                DataTable dt = GetData(query);
                Chart2.DataSource = dt;
                Chart2.Series[0].XValueMember = "Year";
                Chart2.Series[0].YValueMembers = "enrollment";
                Chart2.Series[0].Label = "#VALY";
                Chart2.ChartAreas["ChartArea2"].AxisX.MajorGrid.Enabled = false;
                Chart2.DataBind();

                Chart2.ChartAreas[0].AxisY.Maximum = 180;

                //Target Line:
                StripLine targetLine = new StripLine();
                targetLine.StripWidth = 0;
                targetLine.BorderColor = ColorTranslator.FromHtml("#55efc4");
                targetLine.BorderWidth = 3;
                targetLine.BorderDashStyle = ChartDashStyle.Dash;
                targetLine.IntervalOffset = 74; // In my case I am plotting percentages.
                targetLine.Text = "Per Month Target (74)";
                targetLine.TextOrientation = TextOrientation.Horizontal;
                targetLine.ForeColor = targetLine.BorderColor;
                Chart2.ChartAreas[0].AxisY.StripLines.Add(targetLine);
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }

        }




        //For Cumulative:
        private static DataTable GetData(string query)
        {
            string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;

            MySqlConnection con = new MySqlConnection(constr);
            {
                using (MySqlCommand cmd = new MySqlCommand(query))
                {
                    DataTable dt = new DataTable();
                    using (MySqlDataAdapter sda = new MySqlDataAdapter(query, con))
                    {
                        sda.Fill(dt);
                    }
                    return dt;
                }
            }
        }








        protected void btnSearch_Click(object sender, EventArgs e)
        {
            LoadChartAllSite();

            if (DateTime.ParseExact(txtCalndrDate.Text, "dd-MM-yyyy", CultureInfo.InvariantCulture) > DateTime.ParseExact(txtCalndrDate1.Text, "dd-MM-yyyy", CultureInfo.InvariantCulture))
            {
                showalert("First Date should be Less or Equal than Second Date");
                txtCalndrDate.Focus();
            }
            else
            {
                ShowData();
            }
        }


        private void ShowData()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT  'RG' AS Site, (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Approached' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17!='1' )  AS 'Incomplete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'Complete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'MUAC less than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC equal or greater than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'Any exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'No exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'No exclusion criteria, but consent refused' ,(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'Enrolled'			 UNION ALL 			SELECT  'IH' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Approached' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17!='1' )  AS 'Incomplete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'Complete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'MUAC less than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC equal or greater than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'Any exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'No exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'No exclusion criteria, but consent refused' ,(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'Enrolled'			 UNION ALL 			SELECT  'Cumulative' AS site,(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Approached',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17!='1' )  AS 'Incomplete',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'Complete',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'MUAC less than 30.5 cm',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC equal or greater than 30.5 cm',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'Any exclusion criteria',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'No exclusion criteria',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'No exclusion criteria, but consent refused',(SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'Enrolled'", con);
                //                MySqlCommand cmd = new MySqlCommand("select  (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   as 'Total Approached',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17!='1' )  as 'Incomplete',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1' )  as 'Complete',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1'  and a.pw_crf2_19!='' )  as 'PW died',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25<30.5 )  as 'MUAC less than 30.5 cm',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25>=30.5 )  as 'MUAC equal or greater than 30.5 cm',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25>=30.5 or  a.pw_crf2_33='2' or  a.pw_crf2_34='2' or a.pw_crf2_35='1' or a.pw_crf2_36='1' or a.pw_crf2_37='1' or a.pw_crf2_38='1')  )  as 'Any exclusion criteria',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25<30.5 and a.pw_crf2_33='1' and a.pw_crf2_34='1' and a.pw_crf2_35='2' and a.pw_crf2_36='2' and a.pw_crf2_37='2' and a.pw_crf2_38='2')  )  as 'No exclusion criteria',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_42!='1' )  as 'No exclusion criteria, but consent refused',(select  count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  as 'Enrolled'", con);

                {
                    MySqlDataAdapter sda = new MySqlDataAdapter();
                    {
                        cmd.Connection = con;
                        cmd.CommandTimeout = 0;
                        sda.SelectCommand = cmd;
                        DataTable dt = new DataTable();
                        {
                            sda.Fill(dt);
                            GridView1.DataSource = dt;
                            GridView1.DataBind();
                            //  GridView1.Rows[GridView1.Rows.Count - 1].BackColor = System.Drawing.Color.FromName("#b2bec3");
                            con.Close();
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }





        protected void btnExport_Click(object sender, EventArgs e)
        {
            ShowData();
            if (GridView1.Rows.Count != 0)
            {
                ExcelExportReport();
            }

        }


        protected void btnExport_CRF6_R1_Click(object sender, EventArgs e)
        {
            ExcelExportReport_CRF6_R1();
        }


        protected void btnExport_CRF6_R2_Click(object sender, EventArgs e)
        {
            ExcelExportReport_CRF6_R2();
        }



        public override void VerifyRenderingInServerForm(Control control)
        {
            //base.VerifyRenderingInServerForm(control);
        }








        public void ExcelExportMessage_Report()
        {
            GridView5_1.Caption = "<h2/> MAAMTA PW trial <br/>   <h4> Pregnant Women (PW) screened for eligibility between 8 to 19 weeks - CRF2<br/>Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'";
            GridView6_1.Caption = "<br/><br/>    <h4>Pregnant Women (PW) screened for eligibility between 8 to 19 weeks  - CRF2 <br/>CUMULATIVE REPORT";
            GridView8.Caption = "<br/><br/><br/><br/>    <h4>Current Randomization and Enrollments<br/>Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'";
            GridView9.Caption = "<br/><br/>    <h4>Cumulative Randomization and Enrollments<br/>CUMULATIVE REPORT";
            GridView10.Caption = "<br/><br/>    <h4>Distribution of Enrollments by Gestational Weeks<br/>CUMULATIVE REPORT";
        }






        //CRF-2 Report:
        private void ExportReportdata_01()
        {
            //Date Wise
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                string cmdtxt = "";
                cmdtxt = cmdtxt + "SELECT  'RG' AS site,(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='RG' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  a.site='RG' GROUP BY a.form_crf_1_id) AS z) AS   'Total PW approached', (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='RG' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)    + DATEDIFF(STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'),STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'))  )<56  AND a.site='RG' GROUP BY a.form_crf_1_id) AS z)			 AS 'G.A <8 weeks',";
                cmdtxt = cmdtxt + "((SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE   a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1'   AND z.site='RG'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)>=133   GROUP BY a.form_crf_1_id) AS z) +      (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	) )AS 'G.A >19 weeks', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus>1 GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))   GROUP BY a.form_crf_1_id) AS z) AS 'More than one Fetus', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id)   FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)		AS 'False Pregnancy or Miscariage indentified  (0 weeks)', ";
                cmdtxt = cmdtxt + "(    ((SELECT COUNT(a.form_crf_1_id)   FROM view_crf1 AS a WHERE 	a.site='RG'  AND 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	 a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND	 ((pw_crf_1_30_week * 7)+pw_crf_1_30_days)<133		AND		((pw_crf_1_30_week * 7)+pw_crf_1_30_days   	)>=56 		) + (SELECT COUNT(form_crf_1_id) FROM (SELECT *  FROM view_crf1 AS a WHERE 	a.site='RG'  AND a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND 	(	DATE_ADD(STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), INTERVAL 56-( (pw_crf_1_30_week * 7)+pw_crf_1_30_days) DAY)		BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7) + pw_crf_1_30_days)      )<56  		AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y')		BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))		 GROUP BY a.form_crf_1_id) AS z))	                    -               (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	))	AS 'G.A >8 weeks and <19 weeks and Singleton', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND aa.group_title='3'  AND  STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE  a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT a.assis_id  FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id)  AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND  (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') < STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') )))  AS 'Previously G.A < 8 weeks but Now Eligible', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'Miscarriage/abortion before Eligibility',";
                cmdtxt = cmdtxt + "((SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  + (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' ))  AS 'PW died before Eligibility', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'Shifted out of DSS', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'Refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'Not at home', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))) AS 'Women not approached'";


                cmdtxt = cmdtxt + "UNION ALL SELECT  'IH' AS site,(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='IH' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  a.site='IH' GROUP BY a.form_crf_1_id) AS z) AS   'Total PW approached', (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='IH' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)    + DATEDIFF(STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'),STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'))  )<56  AND a.site='IH' GROUP BY a.form_crf_1_id) AS z)			 AS 'G.A <8 weeks', ";
                cmdtxt = cmdtxt + "(    (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE   a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1'   AND z.site='IH'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)>=133   GROUP BY a.form_crf_1_id) AS z)            +   (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	) )AS 'G.A >19 weeks', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus>1 GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))   GROUP BY a.form_crf_1_id) AS z) AS 'More than one Fetus', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id)   FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)		AS 'False Pregnancy or Miscariage indentified  (0 weeks)', ";
                cmdtxt = cmdtxt + "(     ((SELECT COUNT(a.form_crf_1_id)   FROM view_crf1 AS a WHERE 	a.site='IH'  AND 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	 a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND	 ((pw_crf_1_30_week * 7)+pw_crf_1_30_days)<133		AND		((pw_crf_1_30_week * 7)+pw_crf_1_30_days   	)>=56 		) + (SELECT COUNT(form_crf_1_id) FROM (SELECT *  FROM view_crf1 AS a WHERE 	a.site='IH'  AND a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND 	(	DATE_ADD(STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), INTERVAL 56-( (pw_crf_1_30_week * 7)+pw_crf_1_30_days) DAY)		BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7) + pw_crf_1_30_days)      )<56  		AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y')		BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))		 GROUP BY a.form_crf_1_id) AS z))	                - (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	))	AS 'G.A >8 weeks and <19 weeks and Singleton', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND aa.group_title='3'  AND  STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE  a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT a.assis_id  FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id)  AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND  (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') < STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') )))  AS 'Previously G.A < 8 weeks but Now Eligible', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'Miscarriage/abortion before Eligibility',";
                cmdtxt = cmdtxt + "((SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  + (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' ))  AS 'PW died before Eligibility', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'Shifted out of DSS', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'Refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'Not at home', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))) AS 'Women not approached'";



                cmdtxt = cmdtxt + "UNION ALL  SELECT  'Cumulative' AS site,(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AS z) AS   'Total PW approached', (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)    + DATEDIFF(STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'),STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'))  )<56  GROUP BY a.form_crf_1_id) AS z)			 AS 'G.A <8 weeks', ";
                cmdtxt = cmdtxt + "(    (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE   a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1'   GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)>=133   GROUP BY a.form_crf_1_id) AS z)               +                        (SELECT COUNT(*) FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	)) AS 'G.A >19 weeks', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus>1 GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))   GROUP BY a.form_crf_1_id) AS z) AS 'More than one Fetus', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id)   FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)		AS 'False Pregnancy or Miscariage indentified  (0 weeks)', ";
                cmdtxt = cmdtxt + "(        ((SELECT COUNT(a.form_crf_1_id)   FROM view_crf1 AS a WHERE 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	 a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND	 ((pw_crf_1_30_week * 7)+pw_crf_1_30_days)<133		AND		((pw_crf_1_30_week * 7)+pw_crf_1_30_days   	)>=56 		) + (SELECT COUNT(form_crf_1_id) FROM (SELECT *  FROM view_crf1 AS a WHERE 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND 	(	DATE_ADD(STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), INTERVAL 56-( (pw_crf_1_30_week * 7)+pw_crf_1_30_days) DAY)		BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7) + pw_crf_1_30_days)      )<56  		AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y')		BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))		 GROUP BY a.form_crf_1_id) AS z))	                    -               (SELECT COUNT(*) FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	))	AS 'G.A >8 weeks and <19 weeks and Singleton', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.group_title='3'  AND  STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT a.assis_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id)  AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') < STR_TO_DATE('" + txtCalndrDate.Text + "', '%d-%m-%Y') )))  AS 'Previously G.A < 8 weeks but Now Eligible', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', ";
                cmdtxt = cmdtxt + "((SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' ) + (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' ))  AS 'PW died before Eligibility', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))) AS 'Women not approached'";

                MySqlCommand cmd = new MySqlCommand(cmdtxt, con);

                //  before (01-07-2020)
                //  MySqlCommand cmd = new MySqlCommand("SELECT  'RG' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' UNION ALL SELECT  'IH' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'  UNION ALL SELECT  'Cumulative' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView5_1.DataSource = dt;
                        GridView5_1.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }


        //CRF-2 Report:
        private void ExportReportdata_02()
        {
            //Date Wise
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                string cmdtxt = "";
                cmdtxt = cmdtxt + "SELECT  'RG' AS site,";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' AND a.pw_crf2_18='1')  AS 'PW approached for ICF', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC >= 30.5',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'Known Food Allergy', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'Not willing to stay within DSS until the birth outcome until birth outcome', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW is not permanent resident', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'Working PW', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42='1' )  AS 'PW was screened and consented', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' ";


                cmdtxt = cmdtxt + "UNION ALL SELECT  'IH' AS site,";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' AND a.pw_crf2_18='1')  AS 'PW approached for ICF', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC >= 30.5',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'Known Food AlleIHy', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'Not willing to stay within DSS until the birth outcome until birth outcome', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW is not permanent resident', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'Working PW', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42='1' )  AS 'PW was screened and consented', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' ";



                cmdtxt = cmdtxt + "UNION ALL  SELECT  'Cumulative' AS site,";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_18='1')  AS 'PW approached for ICF', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC >= 30.5', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'Known Food Allergy', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'Not willing to stay within DSS until the birth outcome', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW is not permanent resident', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'Working PW', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42='1' )  AS 'PW was screened and consented', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'";

                MySqlCommand cmd = new MySqlCommand(cmdtxt, con);

                //  before (01-07-2020)
                //  MySqlCommand cmd = new MySqlCommand("SELECT  'RG' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' UNION ALL SELECT  'IH' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'  UNION ALL SELECT  'Cumulative' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView5_2.DataSource = dt;
                        GridView5_2.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }













        private void ExportReportdata_WithOutDate_01()
        {
            //Cumulative
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                string cmdtxt = "";
                cmdtxt = cmdtxt + "SELECT  'RG' AS site,(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='RG' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  a.site='RG' GROUP BY a.form_crf_1_id) AS z) AS   'Total PW approached', (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='RG' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)    + DATEDIFF(STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'),STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'))  )<56  AND a.site='RG' GROUP BY a.form_crf_1_id) AS z)			 AS 'G.A <8 weeks',";
                cmdtxt = cmdtxt + "(    (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE   a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1'   AND z.site='RG'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)>=133   GROUP BY a.form_crf_1_id) AS z)                       +                            (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	))  AS 'G.A >19 weeks', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus>1 GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))   GROUP BY a.form_crf_1_id) AS z) AS 'More than one Fetus', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id)   FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)		AS 'False Pregnancy or Miscariage indentified  (0 weeks)', ";
                cmdtxt = cmdtxt + "(        ((SELECT COUNT(a.form_crf_1_id)   FROM view_crf1 AS a WHERE 	a.site='RG'  AND 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	 a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND	 ((pw_crf_1_30_week * 7)+pw_crf_1_30_days)<133		AND		((pw_crf_1_30_week * 7)+pw_crf_1_30_days   	)>=56 		) + (SELECT COUNT(form_crf_1_id) FROM (SELECT *  FROM view_crf1 AS a WHERE 	a.site='RG'  AND a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='RG'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND 	(	DATE_ADD(STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), INTERVAL 56-( (pw_crf_1_30_week * 7)+pw_crf_1_30_days) DAY)		BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7) + pw_crf_1_30_days)      )<56  		AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y')		BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))		 GROUP BY a.form_crf_1_id) AS z))		-       (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	))   AS 'G.A >8 weeks and <19 weeks and Singleton', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND aa.group_title='3'  AND  STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE  a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT a.assis_id  FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id)  AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND  (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') < STR_TO_DATE('18-03-2019', '%d-%m-%Y') )))  AS 'Previously G.A < 8 weeks but Now Eligible', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'Miscarriage/abortion before Eligibility',";
                cmdtxt = cmdtxt + "((SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  + (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' ))  AS 'PW died before Eligibility', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'Shifted out of DSS', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'Refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'Not at home', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'RG:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='RG' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='RG' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='RG' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))) AS 'Women not approached'";


                cmdtxt = cmdtxt + "UNION ALL SELECT  'IH' AS site,(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='IH' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  a.site='IH' GROUP BY a.form_crf_1_id) AS z) AS   'Total PW approached', (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='IH' AND  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)    + DATEDIFF(STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'),STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'))  )<56  AND a.site='IH' GROUP BY a.form_crf_1_id) AS z)			 AS 'G.A <8 weeks', ";
                cmdtxt = cmdtxt + "(    (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE   a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1'   AND z.site='IH'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)>=133   GROUP BY a.form_crf_1_id) AS z)                +                       (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	) )AS 'G.A >19 weeks', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus>1 GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))   GROUP BY a.form_crf_1_id) AS z) AS 'More than one Fetus', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id)   FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)		AS 'False Pregnancy or Miscariage indentified  (0 weeks)', ";
                cmdtxt = cmdtxt + "(        ((SELECT COUNT(a.form_crf_1_id)   FROM view_crf1 AS a WHERE 	a.site='IH'  AND 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	 a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND	 ((pw_crf_1_30_week * 7)+pw_crf_1_30_days)<133		AND		((pw_crf_1_30_week * 7)+pw_crf_1_30_days   	)>=56 		) + (SELECT COUNT(form_crf_1_id) FROM (SELECT *  FROM view_crf1 AS a WHERE 	a.site='IH'  AND a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.site='IH'  AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH'  AND z.no_of_fetus='1' GROUP BY z.assis_id) AND 	(	DATE_ADD(STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), INTERVAL 56-( (pw_crf_1_30_week * 7)+pw_crf_1_30_days) DAY)		BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7) + pw_crf_1_30_days)      )<56  		AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y')		BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))		 GROUP BY a.form_crf_1_id) AS z))	    -       (SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id	 FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	))	AS 'G.A >8 weeks and <19 weeks and Singleton', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND aa.group_title='3'  AND  STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE  a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH'  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT a.assis_id  FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id)  AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND  (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') < STR_TO_DATE('18-03-2019', '%d-%m-%Y') )))  AS 'Previously G.A < 8 weeks but Now Eligible', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'Miscarriage/abortion before Eligibility',";
                cmdtxt = cmdtxt + "((SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  + (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' ))  AS 'PW died before Eligibility', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'Shifted out of DSS', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'Refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'Not at home', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.dss_id LIKE 'IH:%' AND group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.site='IH' AND a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  WHERE z.site='IH' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE a.site='IH' AND (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))) AS 'Women not approached'";



                cmdtxt = cmdtxt + "UNION ALL  SELECT  'Cumulative' AS site,(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AS z) AS   'Total PW approached', (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)    + DATEDIFF(STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'),STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'))  )<56  GROUP BY a.form_crf_1_id) AS z)			 AS 'G.A <8 weeks', ";
                cmdtxt = cmdtxt + "(    (SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE   a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1'   GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND  	((pw_crf_1_30_week * 7)+pw_crf_1_30_days)>=133   GROUP BY a.form_crf_1_id) AS z)                        +                       (SELECT COUNT(*) FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	)   )   AS 'G.A >19 weeks', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id) FROM (SELECT a.form_crf_1_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus>1 GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))   GROUP BY a.form_crf_1_id) AS z) AS 'More than one Fetus', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(form_crf_1_id)   FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)		AS 'False Pregnancy or Miscariage indentified  (0 weeks)', ";
                cmdtxt = cmdtxt + "(        ((SELECT COUNT(a.form_crf_1_id)   FROM view_crf1 AS a WHERE 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	 a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND	 ((pw_crf_1_30_week * 7)+pw_crf_1_30_days)<133		AND		((pw_crf_1_30_week * 7)+pw_crf_1_30_days   	)>=56 		) + (SELECT COUNT(form_crf_1_id) FROM (SELECT *  FROM view_crf1 AS a WHERE 	a.form_crf_1_id NOT IN (SELECT form_crf_1_id   FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND pw_crf_1_30_week=0 	AND pw_crf_1_30_days=0	)	AND 	a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z WHERE z.no_of_fetus='1' GROUP BY z.assis_id) AND 	(	DATE_ADD(STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), INTERVAL 56-( (pw_crf_1_30_week * 7)+pw_crf_1_30_days) DAY)		BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  AND ( 	((pw_crf_1_30_week * 7) + pw_crf_1_30_days)      )<56  		AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y')		BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))		 GROUP BY a.form_crf_1_id) AS z))		        -(SELECT COUNT(*) FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))            AND aa.pw_assid NOT IN                     (SELECT pw_assid	 FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN        (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assist_code FROM form_crf_2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') )))	)) AS 'G.A >8 weeks and <19 weeks and Singleton', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE aa.group_title='3'  AND  STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE  a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT a.assis_id  FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') BETWEEN STR_TO_DATE('18-03-2019', '%d-%m-%Y') AND STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id)  AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') < STR_TO_DATE('18-03-2019', '%d-%m-%Y') )))  AS 'Previously G.A < 8 weeks but Now Eligible', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', ";
                cmdtxt = cmdtxt + "((SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' ) + (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' ))  AS 'PW died before Eligibility', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', ";
                cmdtxt = cmdtxt + "(SELECT COUNT(*) FROM followups AS aa WHERE group_title='3' AND   	 STR_TO_DATE(aa.end_date, '%d-%m-%Y') >= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND STR_TO_DATE(aa.start_date, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')   AND aa.pw_assid IN (SELECT a.assis_id FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z  GROUP BY z.assis_id) AND (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') >= STR_TO_DATE('17-04-2019', '%d-%m-%Y'))  GROUP BY a.form_crf_1_id) AND aa.pw_assid NOT IN (SELECT assis_id FROM view_crf2 AS a WHERE (STR_TO_DATE(a.pw_crf2_2, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ))) AS 'Women not approached'";

                MySqlCommand cmd = new MySqlCommand(cmdtxt, con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView6_1.DataSource = dt;
                        GridView6_1.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }









        private void ExportReportdata_WithOutDate_02()
        {
            //Cumulative
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                string cmdtxt = "";
                cmdtxt = cmdtxt + "SELECT  'RG' AS site,";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' AND a.pw_crf2_18='1')  AS 'PW approached for ICF', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC >= 30.5',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'Known Food Allergy', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'Not willing to stay within DSS until the birth outcome until birth outcome', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW is not permanent resident', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'Working PW', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42='1' )  AS 'PW was screened and consented', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' ";


                cmdtxt = cmdtxt + "UNION ALL SELECT  'IH' AS site,";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' AND a.pw_crf2_18='1')  AS 'PW approached for ICF', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC >= 30.5',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'Known Food AlleIHy', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'Not willing to stay within DSS until the birth outcome until birth outcome', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW is not permanent resident', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'Working PW', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42='1' )  AS 'PW was screened and consented', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2'  AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' ";



                cmdtxt = cmdtxt + "UNION ALL  SELECT  'Cumulative' AS site,";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_18='1')  AS 'PW approached for ICF', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC >= 30.5', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'Known Food Allergy', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'Not willing to stay within DSS until the birth outcome', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW is not permanent resident', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'Working PW', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42='1' )  AS 'PW was screened and consented', ";
                cmdtxt = cmdtxt + "(SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('18-03-2019' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'";

                MySqlCommand cmd = new MySqlCommand(cmdtxt, con);

                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView6_2.DataSource = dt;
                        GridView6_2.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }





        private void ExportArmReportDateWise()
        {
            //In CRF-2 Report, Add ARM with Date
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-A', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-B',	(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-C', 	 (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) 'ARM-D'  ,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total 			UNION ALL	 SELECT 'IH' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total 			UNION ALL	 SELECT 'Cumulative' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total", con);
                //      MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS Site,'ARM-A' AS ARM,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'RG' AS Site, 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'RG' AS Site,  'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'RG' AS Site,  'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site,'ARM-A' AS ARM,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site, 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site,  'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site,  'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'Cumulative','-', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total", con);

                //    MySqlCommand cmd = new MySqlCommand("select 'ARM-A' as ARM, (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='1' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-B', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='2' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-C', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='3' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-D', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='4' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'Cumulative', (select count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView8.DataSource = dt;
                        GridView8.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }







        private void ExportArmReportWithoutDate()
        {
            //In CRF-2 Report, Add Cumulative ARM
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-A', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-B',	(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-C', 	 (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) 'ARM-D'  ,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS Total 			UNION ALL	 SELECT 'IH' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS Total 			UNION ALL	 SELECT 'Cumulative' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS Total", con);
                //      MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS site,'ARM-A' AS ARM, (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'RG' AS site,'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'RG' AS site,'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'RG' AS site,'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-A' AS ARM, (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'Cumulative','-', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total", con);
                // MySqlCommand cmd = new MySqlCommand("select 'ARM-A' as ARM, (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='1' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-B', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='2' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-C', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='3' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-D', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='4' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'Cumulative', (select count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView9.DataSource = dt;
                        GridView9.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }










        public static DataTable FlipDataTable(DataTable dt)
        {
            DataTable table = new DataTable();
            //Get all the rows and change into columns
            for (int i = 0; i <= dt.Rows.Count; i++)
            {
                table.Columns.Add(Convert.ToString(i));
            }
            DataRow dr;
            //get all the columns and make it as rows
            for (int j = 0; j < dt.Columns.Count; j++)
            {
                dr = table.NewRow();
                dr[0] = dt.Columns[j].ToString();
                for (int k = 1; k <= dt.Rows.Count; k++)
                    dr[k] = dt.Rows[k - 1][j];
                table.Rows.Add(dr);
            }

            return table;
        }



        protected void OnRowDataBound(object sender, GridViewRowEventArgs e)
        {

            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                e.Row.Cells[0].Font.Bold = true;
                e.Row.Cells[0].ForeColor = System.Drawing.Color.White;
                e.Row.Cells[0].Width = 270;
                e.Row.Cells[0].Height = 26;

                e.Row.Cells[0].ForeColor = System.Drawing.Color.FromName("#f5f6fa");
                e.Row.Cells[0].BackColor = System.Drawing.Color.FromName("#1287A5");
                e.Row.Cells[0].BorderColor = System.Drawing.Color.FromName("#1287A5");



                e.Row.Cells[1].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[1].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[1].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[2].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[2].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[2].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[3].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[3].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[3].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[4].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[4].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[4].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[5].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[5].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[5].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[6].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[6].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[6].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[7].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[7].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[7].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[8].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[8].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[8].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[9].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[9].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[9].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[10].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[10].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[10].BorderColor = System.Drawing.Color.FromName("#000000");
                e.Row.Cells[11].ForeColor = System.Drawing.Color.FromName("#284775");
                e.Row.Cells[11].BackColor = System.Drawing.Color.FromName("#FFFFFF");
                e.Row.Cells[11].BorderColor = System.Drawing.Color.FromName("#000000");


         
            }
        }



        private void Export_Enrollments_by_Gestational_Weeks()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT CONCAT(a.pw_crf2_21_weeks,'th Week' )AS Weeks, COUNT(a.pw_crf2_21_weeks) AS n, ROUND(((COUNT(a.pw_crf2_21_weeks)/ (SELECT COUNT(z.pw_crf2_21_weeks) FROM form_crf_2 AS z WHERE z.pw_crf2_42='1' AND STR_TO_DATE(z.pw_crf2_2,'%d-%m-%Y') <=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ))*100),2) AS '%' FROM form_crf_2 AS a WHERE  a.pw_crf2_42='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') <=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.pw_crf2_21_weeks ORDER BY  CONVERT(a.pw_crf2_21_weeks,UNSIGNED INTEGER)", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        cmd.Connection = con;
                        sda.SelectCommand = cmd;
                        DataTable ddt = new DataTable();
                        {
                            GridView10.Visible = true;
                            sda.Fill(ddt);

                            if (ddt.Rows.Count > 0)
                            {
                                GridView10.DataSource = ddt;
                                GridView10.DataSource = FlipDataTable(ddt);
                                GridView10.DataBind();
                                GridView10.HeaderRow.Visible = false;
                            }
                            else
                            {
                                GridView10.DataSource = null;
                                GridView10.DataBind();
                            }
                            con.Close();
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }










        //CRF-2  Report:
        public void ExcelExportReport()
        {
            try
            {
                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;filename=Screening & Enrollment (" + DateTime.Today.ToString("dd-MM-yyyy") + ").xls");
                Response.Charset = "";

                Response.ContentType = "application/vnd.xls";
                System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                System.Web.UI.HtmlTextWriter htmlWrite =
                new HtmlTextWriter(stringWrite);
                GridView5_1.AllowPaging = false;
                GridView5_2.AllowPaging = false;
                GridView6_1.AllowPaging = false;
                GridView6_2.AllowPaging = false;
                GridView8.AllowPaging = false;
                GridView9.AllowPaging = false;
                GridView10.AllowPaging = false;
                ExcelExportMessage_Report();
                GridView5_1.CaptionAlign = TableCaptionAlign.Top;
                GridView5_2.CaptionAlign = TableCaptionAlign.Top;
                GridView6_1.CaptionAlign = TableCaptionAlign.Top;
                GridView6_2.CaptionAlign = TableCaptionAlign.Top;
                GridView8.CaptionAlign = TableCaptionAlign.Top;
                GridView9.CaptionAlign = TableCaptionAlign.Top;
                GridView10.CaptionAlign = TableCaptionAlign.Top;

                ExportReportdata_01();
                ExportReportdata_02();
                ExportReportdata_WithOutDate_01();
                ExportReportdata_WithOutDate_02();
                ExportArmReportDateWise();
                ExportArmReportWithoutDate();
                Export_Enrollments_by_Gestational_Weeks();

                for (int i = 0; i < GridView5_1.HeaderRow.Cells.Count; i++)
                {
                    GridView5_1.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView5_1.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView5_1.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView5_1.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView5_1.Rows[GridView5_1.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView5_1.Rows[GridView5_1.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView5_2.HeaderRow.Cells.Count; i++)
                {
                    GridView5_2.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView5_2.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView5_2.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView5_2.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView5_2.Rows[GridView5_2.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView5_2.Rows[GridView5_2.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView6_1.HeaderRow.Cells.Count; i++)
                {
                    GridView6_1.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView6_1.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView6_1.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView6_1.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView6_1.Rows[GridView6_1.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView6_1.Rows[GridView6_1.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView6_2.HeaderRow.Cells.Count; i++)
                {
                    GridView6_2.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView6_2.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView6_2.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView6_2.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView6_2.Rows[GridView6_2.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView6_2.Rows[GridView6_2.Rows.Count - 1].Font.Bold = true;



                //ARM Report: 
                for (int i = 0; i < GridView8.HeaderRow.Cells.Count; i++)
                {
                    GridView8.HeaderRow.Cells[i].Style.Add("font-size", "16px");
                    GridView8.HeaderRow.Cells[i].Style.Add("height", "50px");
                    GridView8.HeaderRow.Cells[i].Style.Add("background-color", "#e17055");
                    GridView8.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView8.Rows[GridView8.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView8.Rows[GridView8.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView9.HeaderRow.Cells.Count; i++)
                {
                    GridView9.HeaderRow.Cells[i].Style.Add("font-size", "16px");
                    GridView9.HeaderRow.Cells[i].Style.Add("height", "50px");
                    GridView9.HeaderRow.Cells[i].Style.Add("background-color", "#e17055");
                    GridView9.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView9.Rows[GridView9.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView9.Rows[GridView9.Rows.Count - 1].Font.Bold = true;

                //for (int i = 0; i < GridView10.HeaderRow.Cells.Count; i++)
                //{
                //    GridView10.HeaderRow.Cells[i].Style.Add("font-size", "16px");
                //    GridView10.HeaderRow.Cells[i].Style.Add("height", "50px");
                //    GridView10.HeaderRow.Cells[i].Style.Add("background-color", "#1287A5");
                //    GridView10.HeaderRow.Cells[i].Style.Add("Color", "white");
                //}


                GridView5_1.RenderControl(htmlWrite);
                GridView5_2.RenderControl(htmlWrite);
                GridView6_1.RenderControl(htmlWrite);
                GridView6_2.RenderControl(htmlWrite);
                GridView8.RenderControl(htmlWrite);
                GridView9.RenderControl(htmlWrite);
                GridView10.RenderControl(htmlWrite);

                Response.Write(stringWrite.ToString());
                Response.End();
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert(" + ex.Message + ")</script>");
            }
        }










        public void TotalEnrollment()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                MySqlCommand cmd = new MySqlCommand("select count(*) as total from form_crf_3a ", con);
                con.Open();
                MySqlDataReader dr = cmd.ExecuteReader();

                if (dr.Read() == true)
                {
                    lbeTotalEnrollment.Text = dr["total"].ToString();
                }
            }
            finally
            {
                con.Close();
            }
        }


































        public void ExcelExportMessage_ReportCRF6()
        {
            GridView_CRF6_01.Caption = "<h2/> MAAMTA PW trial   <br/>   <h4> Nutritional support and prophylaxis doses of Azithromycin for pregnant women to improve birth outcomes in the peri-urban slums of Karachi, Pakistan –a Randomized Controlled Trials    <br/>       Weekly Progress (CRF-6) Report-1 <br/>       Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'  <br/>   <br/> Azithromycin administration";
            GridView_CRF6_02.Caption = "<br/><br/>    <h4> Outcome Assesment (Hours - Capturing) Live Birth";
            GridView_CRF6_03.Caption = "<br/><br/>    <h4> Outcome Assesment (Hours - Capturing) Still Birth";
            GridView_CRF6_04.Caption = "<br/><br/>    <h4> Outcome Assesment (Hours - Capturing) Miscarriage";
            GridView_CRF6_07.Caption = "<br/><br/>    <h4> Mode of Delivery";
            GridView_CRF6_08.Caption = "<br/><br/>    <h4> High-Risk Participant";
        }





        //CRF-6 Report:
        private void ExportReport_CRF6_01()
        {
            //Table_CRF6_01
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS site, (SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='RG') AS 'Eligigible-20 weeks', 		(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='RG' ) AS Administered_20_Wks, 	 ROUND((((SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='RG' )/(SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='RG'))*100	),1) AS '% Success 20 weeks',  (SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='RG') AS 'Eligible-28 weeks',(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='RG') AS Administered_28_Wks,ROUND((((SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='RG' )/(SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='RG'))*100	),1) AS '% Success 28 weeks', ((SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='RG') 	-	(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='RG' ) ) AS 'Pending 20 Weeks',	((SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='RG') 	-	(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='RG') ) AS 'Pending 28 Weeks' UNION ALL  SELECT 'IH' AS site, (SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='IH') AS 'Eligigible-20 weeks', 		(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='IH' ) AS Administered_20_Wks, 	 ROUND((((SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='IH' )/(SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='IH'))*100	),1) AS '% Success 20 weeks',  (SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='IH') AS 'Eligible-28 weeks',(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='IH') AS Administered_28_Wks,ROUND((((SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='IH' )/(SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='IH'))*100	),1) AS '% Success 28 weeks', ((SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='IH') 	-	(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='IH' ) ) AS 'Pending 20 Weeks',	((SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 AND b.site='IH') 	-	(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND site='IH') ) AS 'Pending 28 Weeks' UNION ALL SELECT 'Cumulative' AS site, (SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 ) AS 'Eligigible-20 weeks', 		(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   ) AS Administered_20_Wks, 	 ROUND((((SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   )/(SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 ))*100	),1) AS '% Success 20 weeks',  (SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 ) AS 'Eligible-28 weeks',(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Administered_28_Wks,ROUND((((SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   )/(SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 ))*100	),1) AS '% Success 28 weeks', ((SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (140-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 ) 	-	(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '1' AND '6' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   ) ) AS 'Pending 20 Weeks',	((SELECT COUNT(b.site) AS total	FROM form_crf_3a AS a LEFT JOIN (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM view_crf1 AS z GROUP BY z.assis_id)) AS b ON SUBSTRING_INDEX(b.assis_id,':',-1)=a.pw_id WHERE a.pw_crf_3a_19='3'	AND DATEDIFF(STR_TO_DATE(DATE_FORMAT(ADDDATE((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL (196-((b.pw_crf_1_30_week * 7) + b.pw_crf_1_30_days)) DAY),'%d-%m-%Y'), '%d-%m-%Y'),STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y'))<=0 ) 	-	(SELECT COUNT(z.site)  FROM view_crf5a AS z 	WHERE z.followup_num BETWEEN '7' AND '14' AND z.pw_crf5a_36='1' AND STR_TO_DATE(z.pw_crf5a_02,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) ) AS 'Pending 28 Weeks' ", con);
                // before (01-07-2020)
                //Outcome Assessment					
                // MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Total UNION  SELECT 'ARM-B' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-C' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-D' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'Cumulative',(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
                // MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-B' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-C' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-D' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'Cumulative',(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_01.DataSource = dt;
                        GridView_CRF6_01.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }



        //CRF-6 Report:
        private void ExportReport_CRF6_02()
        {
            //Table_CRF6_02
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT	'RG' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)'  UNION 		SELECT	'IH' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)'  UNION SELECT	'Cumulative' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)' ", con);
                // before (20-07-2020)

                // MySqlCommand cmd = new MySqlCommand("SELECT	'RG' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)' UNION SELECT	'IH' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)' UNION SELECT	'Cumulative' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)'", con);
                // before (01-07-2020)
                // Live Births			
                // MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term >= 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-B' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-C' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-D' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'Cumulative' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('18-03-2019','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
                // MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-B' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-C' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-D' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'Cumulative' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_02.DataSource = dt;
                        GridView_CRF6_02.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }

        //CRF-6 Report:
        private void ExportReport_CRF6_03()
        {
            //Table_CRF6_03
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT	'RG' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (StillBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)'  UNION 		SELECT	'IH' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)'  UNION SELECT	'Cumulative' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)' ", con);
                // before (20-07-2020)

                // MySqlCommand cmd = new MySqlCommand("SELECT	'RG' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (StillBirth)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)' UNION SELECT	'IH' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (StillBirth)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)' UNION SELECT	'Cumulative' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (StillBirth)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)'", con);
                // before (01-07-2020)
                // Cord Blood Collection Details
                // MySqlCommand cmd = new MySqlCommand("SELECT  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.pw_id=b.pw_id LEFT JOIN lab_investigation AS c ON b.`pw_crf_3a_18`=c.`Randomization_ID` WHERE a.pw_crf_6a_21='1') AS 'Total Live Births',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.pw_id=b.pw_id LEFT JOIN lab_investigation AS c ON b.`pw_crf_3a_18`=c.`Randomization_ID` WHERE a.pw_crf_6a_21='1' AND c.`Description` !='') AS 'Total in Subsample', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.pw_id=b.pw_id LEFT JOIN lab_investigation AS c ON b.`pw_crf_3a_18`=c.`Randomization_ID` WHERE a.pw_crf_6a_21='1' AND c.`Description` !='' AND c.`cord_blood_dt`!='') AS 'Cord Blood Collected'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_03.DataSource = dt;
                        GridView_CRF6_03.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }

        //CRF-6 Report:
        private void ExportReport_CRF6_04()
        {
            //Table_CRF6_04
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT	'RG' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (Miscarriage)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)'  UNION 		SELECT	'IH' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)'  UNION SELECT	'Cumulative' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (LiveBirth)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6) AS '0-5 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 6 ) /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12) AS '6-11 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=6 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-11 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24) AS '12-23 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=12 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 24)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '12-23 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) AS '24-47 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND 			TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=24 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 48) /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-47 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72) AS '48-71 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') >=48 AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') < 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-71 Hrs (%)',  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 ) AS '>= 72 Hours',  ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>=72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '>= 72 Hours (%)' ", con);
                // before (20-07-2020)

                // MySqlCommand cmd = new MySqlCommand("SELECT	'RG' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (Miscarriage)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)' UNION SELECT	'IH' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (Miscarriage)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)' UNION SELECT	'Cumulative' AS Site, (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Eligible Outcomes (Miscarriage)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS '0-5 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '0-5 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS '6-12 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '6-12 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS '13-23 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '13-23 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS '24-48 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '24-48 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS '48-72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72)  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3'AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '48-72 Hrs (%)', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS '> 72 Hours', ROUND((( (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 )  /(SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ))*100),2) AS '> 72 Hours (%)'", con);
                // before (01-07-2020) 
                // New born Capturing Details
                // MySqlCommand cmd = new MySqlCommand("SELECT	'0-5 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'6-12 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 6 AND 12)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=12)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'13-23 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 13 AND 23)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=23)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'24-48 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 24 AND 48)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=48)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'48-72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 49 AND 72)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=72)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'> 72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  >72 )  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage'", con);
                // MySqlCommand cmd = new MySqlCommand("SELECT	'0-5 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'6-12 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 6 AND 12)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=12)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'13-23 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 13 AND 23)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=23)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'24-48 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 24 AND 48)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=48)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'48-72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 49 AND 72)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=72)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'> 72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  >72 )  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_04.DataSource = dt;
                        GridView_CRF6_04.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }







        //CRF-6 Report:
        private void ExportReport_CRF6_07()
        {
            //Table_CRF6_07 (Mode of Delivery)
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT  '(LiveBirth) Vaginal with forceps' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND  pw_crf_6b_35='1' UNION ALL SELECT  '(LiveBirth) Simple Vaginal Delivery' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND  pw_crf_6b_35='2' UNION ALL SELECT  '(LiveBirth) Vaginal with vaccum' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND  pw_crf_6b_35='3' UNION ALL SELECT  '(LiveBirth) Planned C-section' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND  pw_crf_6b_35='4' UNION ALL SELECT  '(LiveBirth) Emergency C-section' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND  pw_crf_6b_35='9'                                   UNION ALL SELECT  '(StillBirth) Vaginal with forceps' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND  pw_crf_6b_35='1' UNION ALL SELECT  '(StillBirth) Simple Vaginal Delivery' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND  pw_crf_6b_35='2' UNION ALL SELECT  '(StillBirth) Vaginal with vaccum' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND  pw_crf_6b_35='3' UNION ALL SELECT  '(StillBirth) Planned C-section' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND  pw_crf_6b_35='4' UNION ALL SELECT  '(StillBirth) Emergency C-section' AS 'Mode of delivery', COUNT(*) AS Total FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND  pw_crf_6b_35='9';", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_07.DataSource = dt;
                        GridView_CRF6_07.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }




        //CRF-6 Report:
        private void ExportReport_CRF6_08()
        {
            //Table_CRF6_08 (Mode of Delivery)
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                string cmdtxt = "";

                cmdtxt = cmdtxt + " SELECT  'Ultrasound' as Form,'Lie- Transverse' as 'High-Risk Participant (First Visit)', count(*) as Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') and pw_crf_1_20='2'";
                cmdtxt = cmdtxt + " union  SELECT 'Ultrasound','Presentation- Breech', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_21='2'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Fetal Heartbeat- Absent', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_22='2'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Fetal Movement- Absent', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_23='2'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Amount of liquor- Scanty', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_33='2'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Amount of liquor- Excess', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_33='3'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Fetal spine- Abnormal', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_34='2'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Placental localization- Posterior wall', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_35_c='3'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Placental localization- Placenta low lying, covering int. Os', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_35_h='8'";
                cmdtxt = cmdtxt + " UNION  SELECT 'Ultrasound','Placental localization- Placenta previa', COUNT(*) AS Total FROM (SELECT * FROM view_crf1 AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)  AND  (STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  GROUP BY a.assis_id ORDER BY STR_TO_DATE(a.pw_crf1_02, '%d-%m-%Y'), STR_TO_DATE(a.pw_crf1_03,  '%H:%i'))  AS TableA  	WHERE  TableA.`assis_id` IN  (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND pw_crf_1_35_k='11'";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Primi gravida',COUNT(*) AS Total FROM anc_form AS a  WHERE STR_TO_DATE(a.anc_form_01, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND  a.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND  anc_form_8='1'";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Gravida (more than 4)',COUNT(*) AS Total FROM anc_form AS a  WHERE STR_TO_DATE(a.anc_form_01, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND  a.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND  anc_form_9>4";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Stillbirths',COUNT(*) AS Total FROM anc_form AS a  WHERE STR_TO_DATE(a.anc_form_01, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND  a.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND  anc_form_11>=1";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Miscarriage/Abortions',COUNT(*) AS Total FROM anc_form AS a  WHERE STR_TO_DATE(a.anc_form_01, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND  a.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND  anc_form_12>=1";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Diabetes Mellitus',COUNT(*) AS Total FROM anc_form AS a  WHERE STR_TO_DATE(a.anc_form_01, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND  a.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND  anc_form_18 LIKE '1:%'";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Congenital abnormalities',COUNT(*) AS Total FROM anc_form AS a  WHERE STR_TO_DATE(a.anc_form_01, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND  a.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND  anc_form_23 LIKE '1:%'";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Hypertension',COUNT(*) AS Total FROM anc_form AS a  WHERE STR_TO_DATE(a.anc_form_01, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y') AND  a.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND  anc_form_27 LIKE '1:%'";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Duration of pregnancy (before 38 weeks) in any outcome',COUNT(*) AS Total  FROM (SELECT * FROM anc_past_ob_history AS a WHERE  a.anc_q13_dop<=4 GROUP BY a.pw_assist_code) AS TableA    WHERE TableA.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') ";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Mode of Delivery (Elective C-section/Emergency operation/Forcep delivery) in any outcome',COUNT(*) AS Total  FROM (SELECT * FROM anc_past_ob_history AS a WHERE   a.anc_q13_mod='2' OR a.anc_q13_mod='3' OR a.anc_q13_mod='4' GROUP BY a.pw_assist_code) AS TableA    WHERE TableA.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') ";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Vital Status (died on 0 Day)',COUNT(*) AS Total  FROM (SELECT * FROM anc_past_ob_history AS a WHERE  a.anc_q13_vital_status='2' GROUP BY a.pw_assist_code) AS TableA    WHERE TableA.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') ";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Congenital anomaly (Cardiac anomaly)',COUNT(*) AS Total  FROM (SELECT * FROM anc_past_ob_history AS a WHERE  a.anc_q13_cn='1' GROUP BY a.pw_assist_code) AS TableA    WHERE TableA.pw_assist_code IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') ";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Oedema',COUNT(*) AS Total  FROM (SELECT * FROM anc_visit_details AS a WHERE a.anc_visit_id  IN  (SELECT MIN(anc_visit_id) FROM anc_visit_details GROUP BY pw_assist_id) AND (STR_TO_DATE(a.date_of_attempt, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) AS TableA   WHERE TableA.pw_assist_id IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND q50_odm='1'";
                cmdtxt = cmdtxt + " UNION  SELECT 'ANC','Anemia',COUNT(*) AS Total  FROM (SELECT * FROM anc_visit_details AS a WHERE a.anc_visit_id  IN  (SELECT MIN(anc_visit_id) FROM anc_visit_details GROUP BY pw_assist_id) AND (STR_TO_DATE(a.date_of_attempt, '%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) AS TableA   WHERE TableA.pw_assist_id IN (SELECT z.`assist_code` FROM form_crf_2 AS z WHERE z.`pw_crf2_42`='1') AND q50_anm='1'";


                MySqlCommand cmd = new MySqlCommand(cmdtxt, con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_08.DataSource = dt;
                        GridView_CRF6_08.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }





        //CRF-6  Report:
        public void ExcelExportReport_CRF6_R1()
        {
            try
            {
                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;filename=CRF-6 Report-1 (" + DateTime.Today.ToString("dd-MM-yyyy") + ").xls");
                Response.Charset = "";

                Response.ContentType = "application/vnd.xls";
                System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                System.Web.UI.HtmlTextWriter htmlWrite =
                new HtmlTextWriter(stringWrite);
                GridView_CRF6_01.AllowPaging = false;
                GridView_CRF6_02.AllowPaging = false;
                GridView_CRF6_03.AllowPaging = false;
                GridView_CRF6_04.AllowPaging = false;
                GridView_CRF6_07.AllowPaging = false;
                GridView_CRF6_08.AllowPaging = false;
                ExcelExportMessage_ReportCRF6();
                GridView_CRF6_01.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_02.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_03.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_04.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_07.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_08.CaptionAlign = TableCaptionAlign.Top;

                ExportReport_CRF6_01();
                ExportReport_CRF6_02();
                ExportReport_CRF6_03();
                ExportReport_CRF6_04();
                ExportReport_CRF6_07();
                ExportReport_CRF6_08();


                for (int i = 0; i < GridView_CRF6_01.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_02.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_03.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_04.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_07.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_07.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_07.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_07.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_07.HeaderRow.Cells[i].Style.Add("Color", "white");
                }

                for (int i = 0; i < GridView_CRF6_08.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_08.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_08.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_08.HeaderRow.Cells[i].Style.Add("background-color", "#1287A5");
                    GridView_CRF6_08.HeaderRow.Cells[i].Style.Add("Color", "white");
                }

                GridView_CRF6_01.RenderControl(htmlWrite);
                GridView_CRF6_02.RenderControl(htmlWrite);
                GridView_CRF6_03.RenderControl(htmlWrite);
                GridView_CRF6_04.RenderControl(htmlWrite);
                GridView_CRF6_07.RenderControl(htmlWrite);
                GridView_CRF6_08.RenderControl(htmlWrite);

                Response.Write(stringWrite.ToString());
                Response.End();
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert(" + ex.Message + ")</script>");
            }
        }


























        public void ExcelExportMessage_ReportCRF6_R2()
        {
            GridView_CRF6_R2_01.Caption = "<h2/> MAAMTA PW trial   <br/>   <h4> Nutritional support and prophylaxis doses of Azithromycin for pregnant women to improve birth outcomes in the peri-urban slums of Karachi, Pakistan –a Randomized Controlled Trials    <br/>       Weekly Progress (CRF-6)  Report-2  <br/>       Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'  <br/>   <br/> Birth Outcomes";
            GridView_CRF6_R2_02.Caption = "<br/><br/>    <h4> Time at which Live Birth captured team";
            GridView_CRF6_R2_03.Caption = "<br/><br/>    <h4> Place of Live Births captured";
            GridView_CRF6_R2_03_Details.Caption = "<br/><br/>    <h4> Place of live births captured (Others detail)";
            GridView_CRF6_R2_06.Caption = "<br/><br/>    <h4> Place of StillBirths captured";
            GridView_CRF6_R2_06_Details.Caption = "<br/><br/>    <h4> Place of Stillbirths captured (Others detail)";
            GridView_CRF6_R2_04.Caption = "<br/><br/>    <h4> Quality indicators of participants delivered (Stillbirths and Live Births)";
            GridView_CRF6_R2_05.Caption = "<br/><br/>    <h4> Anthropometry Indicators";
            GridView_CRF6_R2_07.Caption = "<br/><br/>    <h4> Percent of  live and stillbirths at different facilities (each percent to be calculated from total birth in each month)";
        }





        //CRF-6 Report:
        private void ExportReport_CRF6_R2_01()
        {
            //Table_CRF6_R2_01
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT	'Live births captured within 0-71 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'Cumulative'  UNION SELECT	'Live births captured within >=72 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=72) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=72) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=72) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=72) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=72) AS 'Cumulative'  UNION SELECT	'Stillbirths' AS Indicators,  (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Cumulative'  UNION SELECT	'Miscarriage/Abortion' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Cumulative'  UNION SELECT	'Lost-to-follow-ups birth outcomes' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Cumulative'  UNION SELECT	'Neonatal death before capturing (Note: This number is also included in Live Birth)' AS Indicators,  (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_22='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_22='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_22='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_22='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_22='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Cumulative'  UNION SELECT	'Total' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS 'Cumulative'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_01.DataSource = dt;
                        GridView_CRF6_R2_01.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }



        //CRF-6 Report:
        private void ExportReport_CRF6_R2_02()
        {
            //Table_CRF6_R2_02
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT	'0-5 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<6) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<6) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<6) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<6) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')<6) AS 'Cumulative' UNION SELECT	'6-11 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AS 'Cumulative' UNION SELECT	'12-23 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AS 'Cumulative' UNION SELECT	'24-47 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AS 'Cumulative' UNION SELECT	'48-71 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AS 'Cumulative' UNION SELECT	'>=72 hours' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=72 ) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=72 ) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=72 ) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=72 ) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   AND TIME_FORMAT(a.capturing_duration,'%H')>=72 ) AS 'Cumulative' UNION SELECT	'Total' AS Indicators, (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   ) AS 'ARM-A', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   ) AS 'ARM-B', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   ) AS 'ARM-C', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.arm='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   ) AS 'ARM-D', (SELECT COUNT(*) FROM view_crf6a AS a WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')   ) AS 'Cumulative'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_02.DataSource = dt;
                        GridView_CRF6_R2_02.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }



        //CRF-6 Report:
        private void ExportReport_CRF6_R2_03()
        {
            //Table_CRF6_R2_03
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'KGH' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1') AS 'Cumulative'   UNION SELECT 'AKU Kharadar' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2') AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2') AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2') AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2') AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2') AS 'Cumulative'   UNION SELECT 'AKU Main' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '13') AS 'Cumulative'   UNION SELECT 'JPMC' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'Cumulative'   UNION SELECT 'Civil' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'Cumulative'   UNION SELECT 'VPT Center' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '14') AS 'Cumulative'   UNION SELECT 'Government Hospital' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'Cumulative'   UNION SELECT 'Private Hospital' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'Cumulative'    UNION SELECT 'Maternity Center/Clinic' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'Cumulative'   UNION SELECT 'Home' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1'  AND b.`pw_crf_6b_28` LIKE '10') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1'  AND b.`pw_crf_6b_28` LIKE '10') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1'  AND b.`pw_crf_6b_28` LIKE '10') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1'  AND b.`pw_crf_6b_28` LIKE '10') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1'  AND b.`pw_crf_6b_28` LIKE '10') AS 'Cumulative'    UNION SELECT 'Attiya'	AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '15') AS 'Cumulative'   UNION SELECT 'On the way' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE  STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'Cumulative'    UNION SELECT 'Don`t Know' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9') AS 'Cumulative'   UNION SELECT 'Other' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'Cumulative'   UNION SELECT 'Total' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' ) AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' ) AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' ) AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' ) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' ) AS 'Cumulative'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_03.DataSource = dt;
                        GridView_CRF6_R2_03.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }




        //CRF-6 Report:
        private void ExportReport_CRF6_R2_03_Details()
        {
            //Table_CRF6_R2_03_Details (Mode of Delivery)
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                string cmdtxt = "";

                cmdtxt = cmdtxt + "SELECT  (CASE WHEN c.pw_crf_3a_19='1' THEN 'A'  WHEN c.pw_crf_3a_19='2' THEN 'B' WHEN c.pw_crf_3a_19='3' THEN 'C' WHEN c.pw_crf_3a_19='4' THEN 'D'  END) AS ARM,(CASE    WHEN b.pw_crf_6b_28 LIKE '12:%' THEN SUBSTRING_INDEX(SUBSTRING_INDEX(b.pw_crf_6b_28, ':', 2), ':', -1)      END) AS Others_CRF6a_Q28 FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1'	AND b.`pw_crf_6b_28` LIKE '12:%'  GROUP BY b.`pw_crf_6b_28`";

                MySqlCommand cmd = new MySqlCommand(cmdtxt, con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_03_Details.DataSource = dt;
                        GridView_CRF6_R2_03_Details.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }






        //CRF-6 Report:
        private void ExportReport_CRF6_R2_06()
        {
            //Table_CRF6_R2_06
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'KGH' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'Cumulative'     UNION SELECT 'AKU Kharadar' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'Cumulative'    UNION SELECT 'AKU Main' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '13') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '13') AS 'Cumulative'    UNION SELECT 'JPMC' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'Cumulative'    UNION SELECT 'Civil' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'Cumulative'      UNION SELECT 'VPT Center' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '14') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '14') AS 'Cumulative'    UNION SELECT 'Government Hospital' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'Cumulative'      UNION SELECT 'Private Hospital' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'Cumulative'    UNION SELECT 'Maternity Center/Clinic' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND (  (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND (  (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND (  (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND (  (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND (  (  b.`pw_crf_6b_28` LIKE '7:%'   OR     b.`pw_crf_6b_28` LIKE '8:%'  )   OR     b.`pw_crf_6b_28` LIKE '8:%'  )) AS 'Cumulative'   UNION SELECT 'Home' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'Cumulative'   UNION SELECT 'Attiya'	AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '15') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '15') AS 'Cumulative'  UNION SELECT 'On the way' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE  STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'Cumulative'   UNION SELECT 'Don`t Know' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'Cumulative'  UNION SELECT 'Other' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'Cumulative'  UNION SELECT 'Total' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'Cumulative'", con);
                // (21-09-2020)
                // MySqlCommand cmd = new MySqlCommand("SELECT 'KGH' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'ARM-D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '1') AS 'Cumulative' UNION SELECT 'AKU Kharadar' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '2') AS 'Cumulative' UNION SELECT 'JPMC' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '3' )) AS 'Cumulative' UNION SELECT 'Civil' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '4' )) AS 'Cumulative' UNION SELECT 'Government Hospital' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'A', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'B', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND ( b.`pw_crf_6b_28` LIKE '5:%' )) AS 'Cumulative' UNION SELECT 'Private Hospital' AS Facility,  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'C', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '6:%') AS 'Cumulative'  UNION SELECT 'Maternity Center' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '7:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '7:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '7:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '7:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '7:%') AS 'Cumulative'  UNION SELECT 'Clinic' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '8:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '8:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '8:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '8:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '8:%') AS 'Cumulative'  UNION SELECT 'Home' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='2'  AND b.`pw_crf_6b_28` LIKE '10') AS 'Cumulative'  UNION SELECT 'On the way' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE  STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '11:%') AS 'Cumulative'  UNION SELECT 'Don`t Know' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '9') AS 'Cumulative'  UNION SELECT 'Other' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'D',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' AND b.`pw_crf_6b_28` LIKE '12:%') AS 'Cumulative'  UNION SELECT 'Total' AS Facility,   (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='1' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'A',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='2' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'B',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='3' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'C',  (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE c.pw_crf_3a_19='4' AND STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'D', (SELECT  COUNT(*) FROM  form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE   STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2' ) AS 'Cumulative'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_06.DataSource = dt;
                        GridView_CRF6_R2_06.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }




        //CRF-6 Report:
        private void ExportReport_CRF6_R2_06_Details()
        {
            //Table_CRF6_R2_06_Details (Mode of Delivery)
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                string cmdtxt = "";

                cmdtxt = cmdtxt + "SELECT  (CASE WHEN c.pw_crf_3a_19='1' THEN 'A'  WHEN c.pw_crf_3a_19='2' THEN 'B' WHEN c.pw_crf_3a_19='3' THEN 'C' WHEN c.pw_crf_3a_19='4' THEN 'D'  END) AS ARM,(CASE    WHEN b.pw_crf_6b_28 LIKE '12:%' THEN SUBSTRING_INDEX(SUBSTRING_INDEX(b.pw_crf_6b_28, ':', 2), ':', -1)      END) AS Others_CRF6a_Q28 FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` LEFT JOIN form_crf_3a AS c ON a.study_code=c.study_code  WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='2'	AND b.`pw_crf_6b_28` LIKE '12:%'  GROUP BY b.`pw_crf_6b_28`";


                MySqlCommand cmd = new MySqlCommand(cmdtxt, con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_06_Details.DataSource = dt;
                        GridView_CRF6_R2_06_Details.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }






  //      CRF-6 Report:
        private void ExportReport_CRF6_R2_04()
        {
            //Table_CRF6_R2_04
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT  'ANC visit at clinics <4' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc <4 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc <4 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc <4 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc <4 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc <4 ) AS 'Cumulative' UNION SELECT  'ANC visit at clinics 4-8' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE (total_anc BETWEEN 4 AND 8) AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE (total_anc BETWEEN 4 AND 8) AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE (total_anc BETWEEN 4 AND 8) AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE (total_anc BETWEEN 4 AND 8) AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE (total_anc BETWEEN 4 AND 8) ) AS 'Cumulative' UNION SELECT  'ANC visit at clinics >8' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc >8 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc >8  AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc >8  AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc >8  AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_id`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_id`) AS total_anc FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN anc_visit_details AS c ON c.`pw_id`=b.`pw_id`	 WHERE a.`pw_crf_6a_21` IN (1,2)      AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_anc >8 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound 1 visit only' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =1 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =1 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =1 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =1 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =1 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound 2 visit' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =2 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =2 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =2 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =2 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =2 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound 3 visit' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =3 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =3 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =3 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =3 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =3 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound 4 visit' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =4 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =4 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =4 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =4 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =4 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound 5 visit' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =5 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =5 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =5 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =5 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =5 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound 6 visit' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =6 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =6 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =6 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =6 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =6 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound 7 visit' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =7 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =7 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =7 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =7 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound =7 ) AS 'Cumulative' UNION SELECT  'Longitudnal data of Ultrasound greater than 7 ' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound >7 AND arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound >7 AND arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound >7 AND arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound >7 AND arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT c.`pw_assist_code`,a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2`,COUNT(c.`pw_assist_code`) AS total_ultrasound FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   LEFT JOIN ultrasound_examination AS c ON SUBSTRING_INDEX(c.pw_assist_code,':',-1)=b.`pw_id` WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE total_ultrasound >7 ) AS 'Cumulative' UNION SELECT  'Total stillbirths and live births' AS Indicators, (SELECT  COUNT(study_code)  FROM  (SELECT a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2` FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   	WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE arm='1') AS 'ARM-A', (SELECT  COUNT(study_code)  FROM  (SELECT a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2` FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   	WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE arm='2') AS 'ARM-B', (SELECT  COUNT(study_code)  FROM  (SELECT a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2` FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   	WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE arm='3') AS 'ARM-C', (SELECT  COUNT(study_code)  FROM  (SELECT a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2` FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   	WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA 	WHERE arm='4') AS 'ARM-D', (SELECT  COUNT(study_code)  FROM  (SELECT a.`study_code`,b.`pw_crf_3a_19` AS arm,a.`pw_crf_6a_2` FROM  form_crf_6a AS a  LEFT JOIN form_crf_3a AS b ON a.study_code=b.study_code   	WHERE a.`pw_crf_6a_21` IN (1,2)  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') GROUP BY a.`study_code`) AS TableA)  AS Cumulative", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_04.DataSource = dt;
                        GridView_CRF6_R2_04.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }







     //   CRF-6 Report:
        private void ExportReport_CRF6_R2_05()
        {
            //Table_CRF6_R2_05 (Mode of Delivery)
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT '0-5 hours' AS Indicators,   ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Weight',  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Length', ROUND(((SELECT SUM(a.`pw_crf_6a_30`) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_30`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_30`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean MUAC', ROUND(((SELECT SUM(a.`pw_crf_6a_32`) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_32`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE TIME_FORMAT(a.capturing_duration,'%H')<6 AND a.`pw_crf_6a_32`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean FOC' UNION SELECT '6-11 hours' AS Indicators,   ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Weight',  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Length', ROUND(((SELECT SUM(a.`pw_crf_6a_30`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_30`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_30`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean MUAC', ROUND(((SELECT SUM(a.`pw_crf_6a_32`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_32`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=6 AND TIME_FORMAT(a.capturing_duration,'%H')<12) AND a.`pw_crf_6a_32`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean FOC' UNION SELECT '12-23 hours' AS Indicators,   ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Weight',  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Length', ROUND(((SELECT SUM(a.`pw_crf_6a_30`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_30`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_30`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean MUAC', ROUND(((SELECT SUM(a.`pw_crf_6a_32`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_32`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=12 AND TIME_FORMAT(a.capturing_duration,'%H')<24) AND a.`pw_crf_6a_32`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean FOC' UNION SELECT '24-47 hours' AS Indicators,   ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Weight',  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Length', ROUND(((SELECT SUM(a.`pw_crf_6a_30`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_30`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_30`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean MUAC', ROUND(((SELECT SUM(a.`pw_crf_6a_32`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_32`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=24 AND TIME_FORMAT(a.capturing_duration,'%H')<48) AND a.`pw_crf_6a_32`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean FOC' UNION SELECT '48-71 hours' AS Indicators,   ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Weight',  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Length', ROUND(((SELECT SUM(a.`pw_crf_6a_30`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_30`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_30`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean MUAC', ROUND(((SELECT SUM(a.`pw_crf_6a_32`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_32`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=48 AND TIME_FORMAT(a.capturing_duration,'%H')<72) AND a.`pw_crf_6a_32`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean FOC' UNION SELECT '>=72 hours' AS Indicators,   ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Weight',  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Length', ROUND(((SELECT SUM(a.`pw_crf_6a_30`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_30`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_30`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean MUAC', ROUND(((SELECT SUM(a.`pw_crf_6a_32`) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_32`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM view_crf6a AS a WHERE (TIME_FORMAT(a.capturing_duration,'%H')>=72) AND a.`pw_crf_6a_32`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean FOC' UNION  SELECT 'Cumulative' AS Indicators,   ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Weight',  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Birth Length',  ROUND(((SELECT SUM(a.`pw_crf_6a_30`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_30`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_30`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean MUAC',  ROUND(((SELECT SUM(a.`pw_crf_6a_32`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_32`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_32`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') <= STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean FOC'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_05.DataSource = dt;
                        GridView_CRF6_R2_05.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }





        //   CRF-6 Report:
        private void ExportReport_CRF6_R2_07()
        {
            //Table_CRF6_R2_07 (Skilled birth trends)
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'Skilled' AS  suggested_status,  SUM(CASE WHEN YEAR='Nov-19' AND suggested_status='Skilled' THEN total END) AS 'Nov-19', SUM(CASE WHEN YEAR='Dec-19' AND suggested_status='Skilled'  THEN total END) AS 'Dec-19', SUM(CASE WHEN YEAR='Jan-20' AND suggested_status='Skilled'  THEN total END) AS 'Jan-20', SUM(CASE WHEN YEAR='Feb-20' AND suggested_status='Skilled'  THEN total END) AS 'Feb-20', SUM(CASE WHEN YEAR='Mar-20' AND suggested_status='Skilled'  THEN total END) AS 'Mar-20', SUM(CASE WHEN YEAR='Apr-20' AND suggested_status='Skilled'  THEN total END) AS 'Apr-20', SUM(CASE WHEN YEAR='May-20' AND suggested_status='Skilled'  THEN total END) AS 'May-20', SUM(CASE WHEN YEAR='Jun-20' AND suggested_status='Skilled'  THEN total END) AS 'Jun-20', SUM(CASE WHEN YEAR='Jul-20' AND suggested_status='Skilled'  THEN total END) AS 'Jul-20', SUM(CASE WHEN YEAR='Aug-20' AND suggested_status='Skilled'  THEN total END) AS 'Aug-20', SUM(CASE WHEN YEAR='Sep-20' AND suggested_status='Skilled'  THEN total END) AS 'Sep-20', SUM(CASE WHEN YEAR='Oct-20' AND suggested_status='Skilled'  THEN total END) AS 'Oct-20', SUM(CASE WHEN YEAR='Nov-20' AND suggested_status='Skilled'  THEN total END) AS 'Nov-20', SUM(CASE WHEN YEAR='Dec-20' AND suggested_status='Skilled'  THEN total END) AS 'Dec-20', SUM(CASE WHEN YEAR='Jan-21' AND suggested_status='Skilled'  THEN total END) AS 'Jan-21', SUM(CASE WHEN YEAR='Feb-21' AND suggested_status='Skilled'  THEN total END) AS 'Feb-21', SUM(CASE WHEN YEAR='Mar-21' AND suggested_status='Skilled'  THEN total END) AS 'Mar-21', SUM(CASE WHEN YEAR='Apr-21' AND suggested_status='Skilled'  THEN total END) AS 'Apr-21', SUM(CASE WHEN YEAR='May-21' AND suggested_status='Skilled'  THEN total END) AS 'May-21', SUM(CASE WHEN YEAR='Jun-21' AND suggested_status='Skilled'  THEN total END) AS 'Jun-21', SUM(CASE WHEN YEAR='Jul-21' AND suggested_status='Skilled'  THEN total END) AS 'Jul-21', SUM(CASE WHEN YEAR='Aug-21' AND suggested_status='Skilled'  THEN total END) AS 'Aug-21', SUM(CASE WHEN YEAR='Sep-21' AND suggested_status='Skilled'  THEN total END) AS 'Sep-21', SUM(CASE WHEN YEAR='Oct-21' AND suggested_status='Skilled'  THEN total END) AS 'Oct-21', SUM(CASE WHEN YEAR='Nov-21' AND suggested_status='Skilled'  THEN total END) AS 'Nov-21', SUM(CASE WHEN YEAR='Dec-21' AND suggested_status='Skilled'  THEN total END) AS 'Dec-21', SUM(CASE WHEN YEAR='Jan-22' AND suggested_status='Skilled'  THEN total END) AS 'Jan-22', SUM(CASE WHEN YEAR='Feb-22' AND suggested_status='Skilled'  THEN total END) AS 'Feb-22', SUM(CASE WHEN YEAR='Mar-22' AND suggested_status='Skilled'  THEN total END) AS 'Mar-22', SUM(CASE WHEN YEAR='Apr-22' AND suggested_status='Skilled'  THEN total END) AS 'Apr-22', SUM(CASE WHEN YEAR='May-22' AND suggested_status='Skilled'  THEN total END) AS 'May-22', SUM(CASE WHEN YEAR='Jun-22' AND suggested_status='Skilled'  THEN total END) AS 'Jun-22', SUM(CASE WHEN YEAR='Jul-22' AND suggested_status='Skilled'  THEN total END) AS 'Jul-22', SUM(CASE WHEN YEAR='Aug-22' AND suggested_status='Skilled'  THEN total END) AS 'Aug-22', SUM(CASE WHEN YEAR='Sep-22' AND suggested_status='Skilled'  THEN total END) AS 'Sep-22', SUM(CASE WHEN YEAR='Oct-22' AND suggested_status='Skilled'  THEN total END) AS 'Oct-22', SUM(CASE WHEN YEAR='Nov-22' AND suggested_status='Skilled'  THEN total END) AS 'Nov-22', SUM(CASE WHEN YEAR='Dec-22' AND suggested_status='Skilled'  THEN total END) AS 'Dec-22', SUM(CASE WHEN YEAR='Jan-23' AND suggested_status='Skilled'  THEN total END) AS 'Jan-23', SUM(CASE WHEN YEAR='Feb-23' AND suggested_status='Skilled'  THEN total END) AS 'Feb-23', SUM(CASE WHEN YEAR='Mar-23' AND suggested_status='Skilled'  THEN total END) AS 'Mar-23', SUM(CASE WHEN YEAR='Apr-23' AND suggested_status='Skilled'  THEN total END) AS 'Apr-23', SUM(CASE WHEN YEAR='May-23' AND suggested_status='Skilled'  THEN total END) AS 'May-23', SUM(CASE WHEN YEAR='Jun-23' AND suggested_status='Skilled'  THEN total END) AS 'Jun-23', SUM(CASE WHEN YEAR='Jul-23' AND suggested_status='Skilled'  THEN total END) AS 'Jul-23', SUM(CASE WHEN YEAR='Aug-23' AND suggested_status='Skilled'  THEN total END) AS 'Aug-23', SUM(CASE WHEN YEAR='Sep-23' AND suggested_status='Skilled'  THEN total END) AS 'Sep-23', SUM(CASE WHEN YEAR='Oct-23' AND suggested_status='Skilled'  THEN total END) AS 'Oct-23', SUM(CASE WHEN YEAR='Nov-23' AND suggested_status='Skilled'  THEN total END) AS 'Nov-23', SUM(CASE WHEN YEAR='Dec-23' AND suggested_status='Skilled'  THEN total END) AS 'Dec-23' 			FROM (SELECT	  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%b'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')) AS `YEAR`,		  (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END) AS `suggested_status`,COUNT(`a`.`study_code`) AS `Total` 		  FROM (`form_crf_6a` `a` LEFT JOIN `form_crf_6b` `c` ON((`c`.`study_code` = `a`.`study_code`))) WHERE (`a`.`pw_crf_6a_21` IN (1,2)) 	  AND		STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=  STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  		 GROUP BY (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END),			  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%m'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')))   AS view_skilled_unskilled_graph_suggested	UNION ALL	SELECT 'Other Skilled' AS  suggested_status, 	SUM(CASE WHEN YEAR='Nov-19' AND suggested_status='Other Skilled' THEN total END) AS 'Nov-19',	SUM(CASE WHEN YEAR='Dec-19' AND suggested_status='Other Skilled'  THEN total END) AS 'Dec-19',	SUM(CASE WHEN YEAR='Jan-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Jan-20',	SUM(CASE WHEN YEAR='Feb-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Feb-20',	SUM(CASE WHEN YEAR='Mar-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Mar-20',	SUM(CASE WHEN YEAR='Apr-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Apr-20',	SUM(CASE WHEN YEAR='May-20' AND suggested_status='Other Skilled'  THEN total END) AS 'May-20',	SUM(CASE WHEN YEAR='Jun-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Jun-20',	SUM(CASE WHEN YEAR='Jul-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Jul-20',	SUM(CASE WHEN YEAR='Aug-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Aug-20',	SUM(CASE WHEN YEAR='Sep-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Sep-20',	SUM(CASE WHEN YEAR='Oct-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Oct-20',	SUM(CASE WHEN YEAR='Nov-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Nov-20',	SUM(CASE WHEN YEAR='Dec-20' AND suggested_status='Other Skilled'  THEN total END) AS 'Dec-20',	SUM(CASE WHEN YEAR='Jan-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Jan-21',	SUM(CASE WHEN YEAR='Feb-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Feb-21',	SUM(CASE WHEN YEAR='Mar-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Mar-21',	SUM(CASE WHEN YEAR='Apr-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Apr-21',	SUM(CASE WHEN YEAR='May-21' AND suggested_status='Other Skilled'  THEN total END) AS 'May-21',	SUM(CASE WHEN YEAR='Jun-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Jun-21',	SUM(CASE WHEN YEAR='Jul-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Jul-21',	SUM(CASE WHEN YEAR='Aug-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Aug-21',	SUM(CASE WHEN YEAR='Sep-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Sep-21',	SUM(CASE WHEN YEAR='Oct-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Oct-21',	SUM(CASE WHEN YEAR='Nov-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Nov-21',	SUM(CASE WHEN YEAR='Dec-21' AND suggested_status='Other Skilled'  THEN total END) AS 'Dec-21',	SUM(CASE WHEN YEAR='Jan-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Jan-22',	SUM(CASE WHEN YEAR='Feb-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Feb-22',	SUM(CASE WHEN YEAR='Mar-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Mar-22',	SUM(CASE WHEN YEAR='Apr-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Apr-22',	SUM(CASE WHEN YEAR='May-22' AND suggested_status='Other Skilled'  THEN total END) AS 'May-22',	SUM(CASE WHEN YEAR='Jun-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Jun-22',	SUM(CASE WHEN YEAR='Jul-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Jul-22',	SUM(CASE WHEN YEAR='Aug-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Aug-22',	SUM(CASE WHEN YEAR='Sep-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Sep-22',	SUM(CASE WHEN YEAR='Oct-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Oct-22',	SUM(CASE WHEN YEAR='Nov-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Nov-22',	SUM(CASE WHEN YEAR='Dec-22' AND suggested_status='Other Skilled'  THEN total END) AS 'Dec-22',	SUM(CASE WHEN YEAR='Jan-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Jan-23',	SUM(CASE WHEN YEAR='Feb-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Feb-23',	SUM(CASE WHEN YEAR='Mar-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Mar-23',	SUM(CASE WHEN YEAR='Apr-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Apr-23',	SUM(CASE WHEN YEAR='May-23' AND suggested_status='Other Skilled'  THEN total END) AS 'May-23',	SUM(CASE WHEN YEAR='Jun-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Jun-23',	SUM(CASE WHEN YEAR='Jul-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Jul-23',	SUM(CASE WHEN YEAR='Aug-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Aug-23',	SUM(CASE WHEN YEAR='Sep-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Sep-23',	SUM(CASE WHEN YEAR='Oct-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Oct-23',	SUM(CASE WHEN YEAR='Nov-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Nov-23',	SUM(CASE WHEN YEAR='Dec-23' AND suggested_status='Other Skilled'  THEN total END) AS 'Dec-23' FROM (SELECT	  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%b'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')) AS `YEAR`,		  (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END) AS `suggested_status`,COUNT(`a`.`study_code`) AS `Total` 		  FROM (`form_crf_6a` `a` LEFT JOIN `form_crf_6b` `c` ON((`c`.`study_code` = `a`.`study_code`))) WHERE (`a`.`pw_crf_6a_21` IN (1,2)) 	  AND		STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=  STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  		 GROUP BY (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END),			  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%m'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')))   AS view_skilled_unskilled_graph_suggested UNION ALL			SELECT 'Unskilled' AS  suggested_status, 	SUM(CASE WHEN YEAR='Nov-19' AND suggested_status='Unskilled' THEN total END) AS 'Nov-19',	SUM(CASE WHEN YEAR='Dec-19' AND suggested_status='Unskilled'  THEN total END) AS 'Dec-19',	SUM(CASE WHEN YEAR='Jan-20' AND suggested_status='Unskilled'  THEN total END) AS 'Jan-20',	SUM(CASE WHEN YEAR='Feb-20' AND suggested_status='Unskilled'  THEN total END) AS 'Feb-20',	SUM(CASE WHEN YEAR='Mar-20' AND suggested_status='Unskilled'  THEN total END) AS 'Mar-20',	SUM(CASE WHEN YEAR='Apr-20' AND suggested_status='Unskilled'  THEN total END) AS 'Apr-20',	SUM(CASE WHEN YEAR='May-20' AND suggested_status='Unskilled'  THEN total END) AS 'May-20',	SUM(CASE WHEN YEAR='Jun-20' AND suggested_status='Unskilled'  THEN total END) AS 'Jun-20',	SUM(CASE WHEN YEAR='Jul-20' AND suggested_status='Unskilled'  THEN total END) AS 'Jul-20',	SUM(CASE WHEN YEAR='Aug-20' AND suggested_status='Unskilled'  THEN total END) AS 'Aug-20',	SUM(CASE WHEN YEAR='Sep-20' AND suggested_status='Unskilled'  THEN total END) AS 'Sep-20',	SUM(CASE WHEN YEAR='Oct-20' AND suggested_status='Unskilled'  THEN total END) AS 'Oct-20',	SUM(CASE WHEN YEAR='Nov-20' AND suggested_status='Unskilled'  THEN total END) AS 'Nov-20',	SUM(CASE WHEN YEAR='Dec-20' AND suggested_status='Unskilled'  THEN total END) AS 'Dec-20',	SUM(CASE WHEN YEAR='Jan-21' AND suggested_status='Unskilled'  THEN total END) AS 'Jan-21',	SUM(CASE WHEN YEAR='Feb-21' AND suggested_status='Unskilled'  THEN total END) AS 'Feb-21',	SUM(CASE WHEN YEAR='Mar-21' AND suggested_status='Unskilled'  THEN total END) AS 'Mar-21',	SUM(CASE WHEN YEAR='Apr-21' AND suggested_status='Unskilled'  THEN total END) AS 'Apr-21',	SUM(CASE WHEN YEAR='May-21' AND suggested_status='Unskilled'  THEN total END) AS 'May-21',	SUM(CASE WHEN YEAR='Jun-21' AND suggested_status='Unskilled'  THEN total END) AS 'Jun-21',	SUM(CASE WHEN YEAR='Jul-21' AND suggested_status='Unskilled'  THEN total END) AS 'Jul-21',	SUM(CASE WHEN YEAR='Aug-21' AND suggested_status='Unskilled'  THEN total END) AS 'Aug-21',	SUM(CASE WHEN YEAR='Sep-21' AND suggested_status='Unskilled'  THEN total END) AS 'Sep-21',	SUM(CASE WHEN YEAR='Oct-21' AND suggested_status='Unskilled'  THEN total END) AS 'Oct-21',	SUM(CASE WHEN YEAR='Nov-21' AND suggested_status='Unskilled'  THEN total END) AS 'Nov-21',	SUM(CASE WHEN YEAR='Dec-21' AND suggested_status='Unskilled'  THEN total END) AS 'Dec-21',	SUM(CASE WHEN YEAR='Jan-22' AND suggested_status='Unskilled'  THEN total END) AS 'Jan-22',	SUM(CASE WHEN YEAR='Feb-22' AND suggested_status='Unskilled'  THEN total END) AS 'Feb-22',	SUM(CASE WHEN YEAR='Mar-22' AND suggested_status='Unskilled'  THEN total END) AS 'Mar-22',	SUM(CASE WHEN YEAR='Apr-22' AND suggested_status='Unskilled'  THEN total END) AS 'Apr-22',	SUM(CASE WHEN YEAR='May-22' AND suggested_status='Unskilled'  THEN total END) AS 'May-22',	SUM(CASE WHEN YEAR='Jun-22' AND suggested_status='Unskilled'  THEN total END) AS 'Jun-22',	SUM(CASE WHEN YEAR='Jul-22' AND suggested_status='Unskilled'  THEN total END) AS 'Jul-22',	SUM(CASE WHEN YEAR='Aug-22' AND suggested_status='Unskilled'  THEN total END) AS 'Aug-22',	SUM(CASE WHEN YEAR='Sep-22' AND suggested_status='Unskilled'  THEN total END) AS 'Sep-22',	SUM(CASE WHEN YEAR='Oct-22' AND suggested_status='Unskilled'  THEN total END) AS 'Oct-22',	SUM(CASE WHEN YEAR='Nov-22' AND suggested_status='Unskilled'  THEN total END) AS 'Nov-22',	SUM(CASE WHEN YEAR='Dec-22' AND suggested_status='Unskilled'  THEN total END) AS 'Dec-22',	SUM(CASE WHEN YEAR='Jan-23' AND suggested_status='Unskilled'  THEN total END) AS 'Jan-23',	SUM(CASE WHEN YEAR='Feb-23' AND suggested_status='Unskilled'  THEN total END) AS 'Feb-23',	SUM(CASE WHEN YEAR='Mar-23' AND suggested_status='Unskilled'  THEN total END) AS 'Mar-23',	SUM(CASE WHEN YEAR='Apr-23' AND suggested_status='Unskilled'  THEN total END) AS 'Apr-23',	SUM(CASE WHEN YEAR='May-23' AND suggested_status='Unskilled'  THEN total END) AS 'May-23',	SUM(CASE WHEN YEAR='Jun-23' AND suggested_status='Unskilled'  THEN total END) AS 'Jun-23',	SUM(CASE WHEN YEAR='Jul-23' AND suggested_status='Unskilled'  THEN total END) AS 'Jul-23',	SUM(CASE WHEN YEAR='Aug-23' AND suggested_status='Unskilled'  THEN total END) AS 'Aug-23',	SUM(CASE WHEN YEAR='Sep-23' AND suggested_status='Unskilled'  THEN total END) AS 'Sep-23',	SUM(CASE WHEN YEAR='Oct-23' AND suggested_status='Unskilled'  THEN total END) AS 'Oct-23',	SUM(CASE WHEN YEAR='Nov-23' AND suggested_status='Unskilled'  THEN total END) AS 'Nov-23',	SUM(CASE WHEN YEAR='Dec-23' AND suggested_status='Unskilled'  THEN total END) AS 'Dec-23'	FROM (SELECT	  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%b'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')) AS `YEAR`,		  (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END) AS `suggested_status`,COUNT(`a`.`study_code`) AS `Total` 		  FROM (`form_crf_6a` `a` LEFT JOIN `form_crf_6b` `c` ON((`c`.`study_code` = `a`.`study_code`))) WHERE (`a`.`pw_crf_6a_21` IN (1,2)) 	  AND		STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=  STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  		 GROUP BY (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END),			  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%m'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')))   AS view_skilled_unskilled_graph_suggested UNION ALL	 SELECT 'Undefined (Don`t Know) or (Other)' AS  suggested_status, 	SUM(CASE WHEN YEAR='Nov-19' AND suggested_status='Undefined (Don`t Know) or (Other)' THEN total END) AS 'Nov-19',	SUM(CASE WHEN YEAR='Dec-19' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Dec-19',	SUM(CASE WHEN YEAR='Jan-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jan-20',	SUM(CASE WHEN YEAR='Feb-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Feb-20',	SUM(CASE WHEN YEAR='Mar-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Mar-20',	SUM(CASE WHEN YEAR='Apr-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Apr-20',	SUM(CASE WHEN YEAR='May-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'May-20',	SUM(CASE WHEN YEAR='Jun-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jun-20',	SUM(CASE WHEN YEAR='Jul-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jul-20',	SUM(CASE WHEN YEAR='Aug-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Aug-20',	SUM(CASE WHEN YEAR='Sep-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Sep-20',	SUM(CASE WHEN YEAR='Oct-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Oct-20',	SUM(CASE WHEN YEAR='Nov-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Nov-20',	SUM(CASE WHEN YEAR='Dec-20' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Dec-20',	SUM(CASE WHEN YEAR='Jan-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jan-21',	SUM(CASE WHEN YEAR='Feb-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Feb-21',	SUM(CASE WHEN YEAR='Mar-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Mar-21',	SUM(CASE WHEN YEAR='Apr-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Apr-21',	SUM(CASE WHEN YEAR='May-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'May-21',	SUM(CASE WHEN YEAR='Jun-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jun-21',	SUM(CASE WHEN YEAR='Jul-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jul-21',	SUM(CASE WHEN YEAR='Aug-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Aug-21',	SUM(CASE WHEN YEAR='Sep-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Sep-21',	SUM(CASE WHEN YEAR='Oct-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Oct-21',	SUM(CASE WHEN YEAR='Nov-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Nov-21',	SUM(CASE WHEN YEAR='Dec-21' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Dec-21',	SUM(CASE WHEN YEAR='Jan-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jan-22',	SUM(CASE WHEN YEAR='Feb-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Feb-22',	SUM(CASE WHEN YEAR='Mar-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Mar-22',	SUM(CASE WHEN YEAR='Apr-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Apr-22',	SUM(CASE WHEN YEAR='May-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'May-22',	SUM(CASE WHEN YEAR='Jun-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jun-22',	SUM(CASE WHEN YEAR='Jul-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jul-22',	SUM(CASE WHEN YEAR='Aug-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Aug-22',	SUM(CASE WHEN YEAR='Sep-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Sep-22',	SUM(CASE WHEN YEAR='Oct-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Oct-22',	SUM(CASE WHEN YEAR='Nov-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Nov-22',	SUM(CASE WHEN YEAR='Dec-22' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Dec-22',	SUM(CASE WHEN YEAR='Jan-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jan-23',	SUM(CASE WHEN YEAR='Feb-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Feb-23',	SUM(CASE WHEN YEAR='Mar-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Mar-23',	SUM(CASE WHEN YEAR='Apr-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Apr-23',	SUM(CASE WHEN YEAR='May-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'May-23',	SUM(CASE WHEN YEAR='Jun-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jun-23',	SUM(CASE WHEN YEAR='Jul-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Jul-23',	SUM(CASE WHEN YEAR='Aug-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Aug-23',	SUM(CASE WHEN YEAR='Sep-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Sep-23',	SUM(CASE WHEN YEAR='Oct-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Oct-23',	SUM(CASE WHEN YEAR='Nov-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Nov-23',	SUM(CASE WHEN YEAR='Dec-23' AND suggested_status='Undefined (Don`t Know) or (Other)'  THEN total END) AS 'Dec-23' FROM  (SELECT	  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%b'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')) AS `YEAR`,		  (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END) AS `suggested_status`,COUNT(`a`.`study_code`) AS `Total` 		  FROM (`form_crf_6a` `a` LEFT JOIN `form_crf_6b` `c` ON((`c`.`study_code` = `a`.`study_code`))) WHERE (`a`.`pw_crf_6a_21` IN (1,2)) 	  AND		STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=  STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  		 GROUP BY (CASE WHEN (`c`.`pw_crf_6b_28` IN (1,2,3,4,13,14,15)) THEN 'Skilled' WHEN ((`c`.`pw_crf_6b_28` LIKE '5:%') OR (`c`.`pw_crf_6b_28` LIKE '6:%') OR (`c`.`pw_crf_6b_28` LIKE '7:%') OR (`c`.`pw_crf_6b_28` LIKE '8:%') OR (`c`.`pw_crf_6b_28` LIKE '11:%')) THEN 'Other Skilled' WHEN ((`c`.`pw_crf_6b_28` = '9') OR (`c`.`pw_crf_6b_28` LIKE '12:%')) THEN 'Undefined (Don`t Know) or (Other)' WHEN (`c`.`pw_crf_6b_28` = '10') THEN 'Unskilled' END),			  CONCAT(DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%m'),'-',DATE_FORMAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),'%y')))   AS view_skilled_unskilled_graph_suggested", con);

                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 999999;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_R2_07.DataSource = dt;
                        GridView_CRF6_R2_07.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }












        //CRF-6  Report:
        public void ExcelExportReport_CRF6_R2()
        {
            try
            {
                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;filename=Birth Outcome (" + DateTime.Today.ToString("dd-MM-yyyy") + ").xls");
                Response.Charset = "";

                Response.ContentType = "application/vnd.xls";
                System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                System.Web.UI.HtmlTextWriter htmlWrite =
                new HtmlTextWriter(stringWrite);
                GridView_CRF6_R2_01.AllowPaging = false;
                GridView_CRF6_R2_02.AllowPaging = false;
                GridView_CRF6_R2_03.AllowPaging = false;
                GridView_CRF6_R2_06.AllowPaging = false;
                GridView_CRF6_R2_04.AllowPaging = false;
                GridView_CRF6_R2_05.AllowPaging = false;
                GridView_CRF6_R2_03_Details.AllowPaging = false;
                GridView_CRF6_R2_06_Details.AllowPaging = false;
                GridView_CRF6_R2_07.AllowPaging = false;
                ExcelExportMessage_ReportCRF6_R2();
                GridView_CRF6_R2_01.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_02.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_03.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_06.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_04.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_05.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_03_Details.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_06_Details.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_R2_07.CaptionAlign = TableCaptionAlign.Top;

                ExportReport_CRF6_R2_01();
                ExportReport_CRF6_R2_02();
                ExportReport_CRF6_R2_03();
                ExportReport_CRF6_R2_04();
                ExportReport_CRF6_R2_05();
                ExportReport_CRF6_R2_06();
                ExportReport_CRF6_R2_03_Details();
                ExportReport_CRF6_R2_06_Details();
                ExportReport_CRF6_R2_07();


                for (int i = 0; i < GridView_CRF6_R2_01.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_R2_01.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_R2_01.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_R2_01.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_R2_01.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_R2_02.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_R2_02.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_R2_02.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_R2_02.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_R2_02.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_R2_03.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_R2_03.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_R2_03.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_R2_03.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_R2_03.HeaderRow.Cells[i].Style.Add("Color", "white");
                }

                //for (int i = 0; i < GridView_CRF6_R2_03_Details.HeaderRow.Cells.Count; i++)
                //{
                //    GridView_CRF6_R2_03_Details.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                //    GridView_CRF6_R2_03_Details.HeaderRow.Cells[i].Style.Add("height", "90px");
                //    GridView_CRF6_R2_03_Details.HeaderRow.Cells[i].Style.Add("background-color", "#1287A5");
                //    GridView_CRF6_R2_03_Details.HeaderRow.Cells[i].Style.Add("Color", "white");
                //}


                for (int i = 0; i < GridView_CRF6_R2_06.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_R2_06.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_R2_06.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_R2_06.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_R2_06.HeaderRow.Cells[i].Style.Add("Color", "white");
                }

                //for (int i = 0; i < GridView_CRF6_R2_06_Details.HeaderRow.Cells.Count; i++)
                //{
                //    GridView_CRF6_R2_06_Details.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                //    GridView_CRF6_R2_06_Details.HeaderRow.Cells[i].Style.Add("height", "90px");
                //    GridView_CRF6_R2_06_Details.HeaderRow.Cells[i].Style.Add("background-color", "#1287A5");
                //    GridView_CRF6_R2_06_Details.HeaderRow.Cells[i].Style.Add("Color", "white");
                //}





                for (int i = 0; i < GridView_CRF6_R2_04.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_R2_04.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_R2_04.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_R2_04.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_R2_04.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_R2_05.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_R2_05.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_R2_05.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_R2_05.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_R2_05.HeaderRow.Cells[i].Style.Add("Color", "white");
                }

                for (int i = 0; i < GridView_CRF6_R2_07.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_R2_07.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_R2_07.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_R2_07.HeaderRow.Cells[i].Style.Add("background-color", "#53E0BC");
                    GridView_CRF6_R2_07.HeaderRow.Cells[i].Style.Add("Color", "white");
                }

                GridView_CRF6_R2_01.RenderControl(htmlWrite);
                GridView_CRF6_R2_02.RenderControl(htmlWrite);
                GridView_CRF6_R2_03.RenderControl(htmlWrite);
                GridView_CRF6_R2_03_Details.RenderControl(htmlWrite);
                GridView_CRF6_R2_06.RenderControl(htmlWrite);
                GridView_CRF6_R2_06_Details.RenderControl(htmlWrite);
                GridView_CRF6_R2_04.RenderControl(htmlWrite);
                GridView_CRF6_R2_05.RenderControl(htmlWrite);
                GridView_CRF6_R2_07.RenderControl(htmlWrite);

                Response.Write(stringWrite.ToString());
                Response.End();
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert(" + ex.Message + ")</script>");
            }
        }





    }
}