using MySql.Data.MySqlClient;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Globalization;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.DataVisualization.Charting;
using System.Drawing;

namespace maamta_pw
{
    public partial class dashboardRandom : System.Web.UI.Page
    {


        string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;

        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                Session["WebForm"] = "DashboardRandom";



                txtCalndrDate.Text = DateTime.Now.ToString("dd-MM-yyyy");
                txtCalndrDate1.Text = DateTime.Now.ToString("dd-MM-yyyy");

                txtCalndrDate.Attributes.Add("readonly", "readonly");
                txtCalndrDate1.Attributes.Add("readonly", "readonly");

                TotalEnrollment();
                ShowData();
                LoadChartAllSite();
            }
        }


        public void showalert(string message)
        {
            string script = @"alert('" + message + "');";
            ScriptManager.RegisterStartupScript(this, this.GetType(), "Alert", script, true);
        }









        private void LoadChartAllSite()
        {
            try
            {
                string query = string.Format("select concat(Date_Format(str_to_date(pw_crf_3a_2, '%d-%m-%Y'),'%b'),'-',Date_Format(str_to_date(pw_crf_3a_2, '%d-%m-%Y'),'%y')) as Year, count(*) as enrollment	   from form_crf_3a group by Year(str_to_date(pw_crf_3a_2, '%d-%m-%Y')),Month(str_to_date(pw_crf_3a_2, '%d-%m-%Y'))");
                DataTable dt = GetData(query);
                Chart2.DataSource = dt;
                Chart2.Series[0].XValueMember = "Year";
                Chart2.Series[0].YValueMembers = "enrollment";
                Chart2.Series[0].Label = "#VALY";
                Chart2.ChartAreas["ChartArea2"].AxisX.MajorGrid.Enabled = false;
                Chart2.DataBind();

                Chart2.ChartAreas[0].AxisY.Maximum = 120;

                //Target Line:
                StripLine targetLine = new StripLine();
                targetLine.StripWidth = 0;
                targetLine.BorderColor = ColorTranslator.FromHtml("#55efc4");
                targetLine.BorderWidth = 3;
                targetLine.BorderDashStyle = ChartDashStyle.Dash;
                targetLine.IntervalOffset = 74; // In my case I am plotting percentages.
                targetLine.Text = "Per Month Target (74)";
                targetLine.TextOrientation = TextOrientation.Horizontal;
                targetLine.ForeColor = targetLine.BorderColor;
                Chart2.ChartAreas[0].AxisY.StripLines.Add(targetLine);
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }

        }




        //For Cumulative:
        private static DataTable GetData(string query)
        {
            string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;

            MySqlConnection con = new MySqlConnection(constr);
            {
                using (MySqlCommand cmd = new MySqlCommand(query))
                {
                    DataTable dt = new DataTable();
                    using (MySqlDataAdapter sda = new MySqlDataAdapter(query, con))
                    {
                        sda.Fill(dt);
                    }
                    return dt;
                }
            }
        }








        protected void btnSearch_Click(object sender, EventArgs e)
        {
            LoadChartAllSite();

            if (DateTime.ParseExact(txtCalndrDate.Text, "dd-MM-yyyy", CultureInfo.InvariantCulture) > DateTime.ParseExact(txtCalndrDate1.Text, "dd-MM-yyyy", CultureInfo.InvariantCulture))
            {
                showalert("First Date should be Less or Equal than Second Date");
                txtCalndrDate.Focus();
            }
            else
            {
                ShowData();
            }
        }


        private void ShowData()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT  'RG' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Approached' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17!='1' )  AS 'Incomplete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'Complete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'MUAC less than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC equal or greater than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'Any exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'No exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'No exclusion criteria, but consent refused' ,(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'Enrolled'			 UNION ALL 			SELECT  'IH' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Approached' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17!='1' )  AS 'Incomplete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'Complete' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'MUAC less than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC equal or greater than 30.5 cm' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'Any exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'No exclusion criteria' ,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'No exclusion criteria, but consent refused' ,(SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'Enrolled'			 UNION ALL 			SELECT  'Cumulative' AS site,(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Approached',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17!='1' )  AS 'Incomplete',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'Complete',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'MUAC less than 30.5 cm',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'MUAC equal or greater than 30.5 cm',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'Any exclusion criteria',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'No exclusion criteria',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'No exclusion criteria, but consent refused',(SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'Enrolled'", con);
                //                MySqlCommand cmd = new MySqlCommand("select  (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   as 'Total Approached',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17!='1' )  as 'Incomplete',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1' )  as 'Complete',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1'  and a.pw_crf2_19!='' )  as 'PW died',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25<30.5 )  as 'MUAC less than 30.5 cm',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25>=30.5 )  as 'MUAC equal or greater than 30.5 cm',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25>=30.5 or  a.pw_crf2_33='2' or  a.pw_crf2_34='2' or a.pw_crf2_35='1' or a.pw_crf2_36='1' or a.pw_crf2_37='1' or a.pw_crf2_38='1')  )  as 'Any exclusion criteria',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25<30.5 and a.pw_crf2_33='1' and a.pw_crf2_34='1' and a.pw_crf2_35='2' and a.pw_crf2_36='2' and a.pw_crf2_37='2' and a.pw_crf2_38='2')  )  as 'No exclusion criteria',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_42!='1' )  as 'No exclusion criteria, but consent refused',(select  count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  as 'Enrolled'", con);

                {
                    MySqlDataAdapter sda = new MySqlDataAdapter();
                    {
                        cmd.Connection = con;
                        cmd.CommandTimeout = 0;
                        sda.SelectCommand = cmd;
                        DataTable dt = new DataTable();
                        {
                            sda.Fill(dt);
                            GridView1.DataSource = dt;
                            GridView1.DataBind();
                            //  GridView1.Rows[GridView1.Rows.Count - 1].BackColor = System.Drawing.Color.FromName("#b2bec3");
                            con.Close();
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }





        protected void btnExport_Click(object sender, EventArgs e)
        {
            ShowData();
            if (GridView1.Rows.Count != 0)
            {
                ExcelExportReport();
            }

        }


        protected void btnExport_CRF6_Click(object sender, EventArgs e)
        {
            ExcelExportReport_CRF6();
        }




        public override void VerifyRenderingInServerForm(Control control)
        {
            //base.VerifyRenderingInServerForm(control);
        }








        public void ExcelExportMessage_Report()
        {
            GridView5.Caption = "<h2/> MAAMTA PW trial <br/>   <h4> Pregnant Women (PW) screened for eligibility between 8 to 19 weeks - CRF2<br/>Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'";
            GridView6.Caption = "<br/><br/>    <h4>Pregnant Women (PW) screened for eligibility between 8 to 19 weeks  - CRF2 <br/>CUMULATIVE REPORT";
            GridView8.Caption = "<br/><br/><br/><br/>    <h4>Current Randomization and Enrollments<br/>Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'";
            GridView9.Caption = "<br/><br/>    <h4>Cumulative Randomization and Enrollments<br/>CUMULATIVE REPORT";
        }





        //CRF-2 Report:
        private void ExportReportdata()
        {
            //Date Wise
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT  'RG' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' UNION ALL SELECT  'IH' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'  UNION ALL SELECT  'Cumulative' AS Site,(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'", con);
                // MySqlCommand cmd = new MySqlCommand("select  (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   as 'Total Pregnant Women Approached', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1'  and a.pw_crf2_19!='' )  as 'PW died before screening', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='6' )  as 'PW was not screened as outcome was Miscarriage/Abortion', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='4' )  as 'PW was not screened as Shifted out of DSS', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='3' )  as 'PW was not screened as Refused', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='2' )  as 'PW was not screened as not at home', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='5' )  as 'PW was died during pregnancy and baby also died inside', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1' )  as 'PW was screened eligibility', ('') as 'Break Line', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25<30.5 )  as 'Eligible pregnant women as MUAC less than 30.5 cm', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25>=30.5 )  as 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_33='2' )  as 'PW was not permanent resident of DSS', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_34='2' )  as 'PW was not continues to stay within DSS until birth outcome', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_35='1' )  as 'PW was working outside the home due to which she is unable to attend ANC visits', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_36='1' )  as 'PW was enrolled in Maamta PW trial in the past',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_37='1' )  as 'PW was enrolled in Maamta LW trial in the past',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_38='1' )  as 'PW has any known allergy to food items like peanut, milk, lentils', ('') as 'Break Line', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25>=30.5 or  a.pw_crf2_33='2' or  a.pw_crf2_34='2' or a.pw_crf2_35='1' or a.pw_crf2_36='1' or a.pw_crf2_37='1' or a.pw_crf2_38='1')  )  as 'PW was screened and has any exclusion criteria', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25<30.5 and a.pw_crf2_33='1' and a.pw_crf2_34='1' and a.pw_crf2_35='2' and a.pw_crf2_36='2' and a.pw_crf2_37='2' and a.pw_crf2_38='2')  )  as 'PW was screened with no exclusion criteria', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_42!='1' )  as 'PW was screened with no exclusion criteria, but consent refused', (select  count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  as 'PW was screened with no exclusion criteria, and Enrolled'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView5.DataSource = dt;
                        GridView5.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }






        private void ExportReportdata_WithOutDate()
        {
            //Cumulative
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT  'RG' AS Site, (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' UNION ALL SELECT  'IH' AS Site, (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled' UNION ALL SELECT  'Cumulative' AS Site, (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   AS 'Total Pregnant Women Approached', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1'  AND a.pw_crf2_19!='' )  AS 'PW died before screening', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='6' )  AS 'PW was not screened as outcome was Miscarriage/Abortion', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='4' )  AS 'PW was not screened as Shifted out of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='3' )  AS 'PW was not screened as Refused', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='2' )  AS 'PW was not screened as not at home', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='5' )  AS 'PW was died during pregnancy and baby also died inside', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_17='1' )  AS 'PW was screened eligibility', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25<30.5 )  AS 'Eligible pregnant women as MUAC less than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_25>=30.5 )  AS 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_33='2' )  AS 'PW was not permanent resident of DSS', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_34='2' )  AS 'PW was not continues to stay within DSS until birth outcome', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_35='1' )  AS 'PW was working outside the home due to which she is unable to attend ANC visits', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_36='1' )  AS 'PW was enrolled in Maamta PW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_37='1' )  AS 'PW was enrolled in Maamta LW trial in the past',(SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_38='1' )  AS 'PW has any known allergy to food items like peanut, milk, lentils', ('') AS 'Break Line', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25>=30.5 OR  a.pw_crf2_33='2' OR  a.pw_crf2_34='2' OR a.pw_crf2_35='1' OR a.pw_crf2_36='1' OR a.pw_crf2_37='1' OR a.pw_crf2_38='1')  )  AS 'PW was screened and has any exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  (a.pw_crf2_25<30.5 AND a.pw_crf2_33='1' AND a.pw_crf2_34='1' AND a.pw_crf2_35='2' AND a.pw_crf2_36='2' AND a.pw_crf2_37='2' AND a.pw_crf2_38='2')  )  AS 'PW was screened with no exclusion criteria', (SELECT  COUNT(*) FROM form_crf_2 AS a WHERE STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 AND  a.pw_crf2_42!='1' )  AS 'PW was screened with no exclusion criteria, but consent refused', (SELECT  COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  AS 'PW was screened with no exclusion criteria, and Enrolled'", con);
                // MySqlCommand cmd = new MySqlCommand("select  (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	)   as 'Total Pregnant Women Approached', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1'  and a.pw_crf2_19!='' )  as 'PW died before screening', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='6' )  as 'PW was not screened as outcome was Miscarriage/Abortion', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='4' )  as 'PW was not screened as Shifted out of DSS', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='3' )  as 'PW was not screened as Refused', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='2' )  as 'PW was not screened as not at home', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='5' )  as 'PW was died during pregnancy and baby also died inside', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_17='1' )  as 'PW was screened eligibility', ('') as 'Break Line', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25<30.5 )  as 'Eligible pregnant women as MUAC less than 30.5 cm', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_25>=30.5 )  as 'Not eligible pregnant women as MUAC equal or greater than 30.5 cm', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_33='2' )  as 'PW was not permanent resident of DSS', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_34='2' )  as 'PW was not continues to stay within DSS until birth outcome', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_35='1' )  as 'PW was working outside the home due to which she is unable to attend ANC visits', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_36='1' )  as 'PW was enrolled in Maamta PW trial in the past',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_37='1' )  as 'PW was enrolled in Maamta LW trial in the past',(select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_38='1' )  as 'PW has any known allergy to food items like peanut, milk, lentils', ('') as 'Break Line', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25>=30.5 or  a.pw_crf2_33='2' or  a.pw_crf2_34='2' or a.pw_crf2_35='1' or a.pw_crf2_36='1' or a.pw_crf2_37='1' or a.pw_crf2_38='1')  )  as 'PW was screened and has any exclusion criteria', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  (a.pw_crf2_25<30.5 and a.pw_crf2_33='1' and a.pw_crf2_34='1' and a.pw_crf2_35='2' and a.pw_crf2_36='2' and a.pw_crf2_37='2' and a.pw_crf2_38='2')  )  as 'PW was screened with no exclusion criteria', (select  count(*) from form_crf_2 as a where STR_TO_DATE(a.pw_crf2_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	 and  a.pw_crf2_42!='1' )  as 'PW was screened with no exclusion criteria, but consent refused', (select  count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  )  as 'PW was screened with no exclusion criteria, and Enrolled'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView6.DataSource = dt;
                        GridView6.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }




        private void ExportArmReportDateWise()
        {
            //In CRF-2 Report, Add ARM with Date
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-A', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-B',	(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-C', 	 (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) 'ARM-D'  ,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total 			UNION ALL	 SELECT 'IH' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total 			UNION ALL	 SELECT 'Cumulative' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total", con);
                //      MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS Site,'ARM-A' AS ARM,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'RG' AS Site, 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'RG' AS Site,  'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'RG' AS Site,  'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site,'ARM-A' AS ARM,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site, 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site,  'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'IH' AS Site,  'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	 SELECT 'Cumulative','-', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	BETWEEN		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 AND	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total", con);
            
            //    MySqlCommand cmd = new MySqlCommand("select 'ARM-A' as ARM, (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='1' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-B', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='2' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-C', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='3' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-D', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='4' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'Cumulative', (select count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	between		STR_TO_DATE('" + txtCalndrDate.Text + "' ,'%d-%m-%Y')	 and	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView8.DataSource = dt;
                        GridView8.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }







        private void ExportArmReportWithoutDate()
        {
            //In CRF-2 Report, Add Cumulative ARM
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-A', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-B',	(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-C', 	 (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) 'ARM-D'  ,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS Total 			UNION ALL	 SELECT 'IH' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS Total 			UNION ALL	 SELECT 'Cumulative' AS Site,(SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-A' , (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) 'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS 'ARM-D',(SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')		  ) AS Total", con);
          //      MySqlCommand cmd = new MySqlCommand("SELECT 'RG' AS site,'ARM-A' AS ARM, (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'RG' AS site,'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'RG' AS site,'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'RG' AS site,'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='1' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-A' AS ARM, (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='1' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-B', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='2' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-C', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='3' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'IH' AS site,'ARM-D', (SELECT COUNT(*) FROM form_crf_3a AS a LEFT JOIN team AS b ON a.team_id=b.team_id WHERE b.site_id='2' AND a.pw_crf_3a_19='4' AND  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total	 UNION ALL	SELECT 'Cumulative','-', (SELECT COUNT(*) FROM form_crf_3a AS a WHERE STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) AS Total", con);
                // MySqlCommand cmd = new MySqlCommand("select 'ARM-A' as ARM, (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='1' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-B', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='2' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-C', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='3' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'ARM-D', (select count(*) from form_crf_3a as a where a.pw_crf_3a_19='4' and  STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total	union all	select 'Cumulative', (select count(*) from form_crf_3a as a where STR_TO_DATE(a.pw_crf_3a_2,'%d-%m-%Y') 	<=	 STR_TO_DATE('" + txtCalndrDate1.Text + "' ,'%d-%m-%Y')	  ) as Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView9.DataSource = dt;
                        GridView9.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }







        //CRF-2  Report:
        public void ExcelExportReport()
        {
            try
            {
                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;filename=CRF-2 Report (" + DateTime.Today.ToString("dd-MM-yyyy") + ").xls");
                Response.Charset = "";

                Response.ContentType = "application/vnd.xls";
                System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                System.Web.UI.HtmlTextWriter htmlWrite =
                new HtmlTextWriter(stringWrite);
                GridView5.AllowPaging = false;
                GridView6.AllowPaging = false;
                GridView8.AllowPaging = false;
                GridView9.AllowPaging = false;
                ExcelExportMessage_Report();
                GridView5.CaptionAlign = TableCaptionAlign.Top;
                GridView6.CaptionAlign = TableCaptionAlign.Top;
                GridView8.CaptionAlign = TableCaptionAlign.Top;
                GridView9.CaptionAlign = TableCaptionAlign.Top;

                ExportReportdata();
                ExportReportdata_WithOutDate();
                ExportArmReportDateWise();
                ExportArmReportWithoutDate();

                for (int i = 0; i < GridView5.HeaderRow.Cells.Count; i++)
                {
                    GridView5.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView5.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView5.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView5.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView5.Rows[GridView5.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView5.Rows[GridView5.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView6.HeaderRow.Cells.Count; i++)
                {
                    GridView6.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView6.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView6.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView6.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView6.Rows[GridView6.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView6.Rows[GridView6.Rows.Count - 1].Font.Bold = true;


                //ARM Report: 
                for (int i = 0; i < GridView8.HeaderRow.Cells.Count; i++)
                {
                    GridView8.HeaderRow.Cells[i].Style.Add("font-size", "16px");
                    GridView8.HeaderRow.Cells[i].Style.Add("height", "50px");
                    GridView8.HeaderRow.Cells[i].Style.Add("background-color", "#e17055");
                    GridView8.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView8.Rows[GridView8.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView8.Rows[GridView8.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView9.HeaderRow.Cells.Count; i++)
                {
                    GridView9.HeaderRow.Cells[i].Style.Add("font-size", "16px");
                    GridView9.HeaderRow.Cells[i].Style.Add("height", "50px");
                    GridView9.HeaderRow.Cells[i].Style.Add("background-color", "#e17055");
                    GridView9.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView9.Rows[GridView9.Rows.Count - 1].Style.Add("font-size", "17px");
                GridView9.Rows[GridView9.Rows.Count - 1].Font.Bold = true;


                GridView5.RenderControl(htmlWrite);
                GridView6.RenderControl(htmlWrite);
                GridView8.RenderControl(htmlWrite);
                GridView9.RenderControl(htmlWrite);

                Response.Write(stringWrite.ToString());
                Response.End();
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert(" + ex.Message + ")</script>");
            }
        }










        public void TotalEnrollment()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                MySqlCommand cmd = new MySqlCommand("select count(*) as total from form_crf_3a ", con);
                con.Open();
                MySqlDataReader dr = cmd.ExecuteReader();

                if (dr.Read() == true)
                {
                    lbeTotalEnrollment.Text = dr["total"].ToString();
                }
            }
            finally
            {
                con.Close();
            }
        }


































        public void ExcelExportMessage_ReportCRF6()
        {
            GridView_CRF6_01.Caption = "<h2/> MAAMTA PW trial   <br/>   <h4> Nutritional support and prophylaxis doses of Azithromycin for pregnant women to improve birth outcomes in the peri-urban slums of Karachi, Pakistan –a Randomized Controlled Trials    <br/>       Weekly Progress Report  (Outcome Details)   <br/>       Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'  <br/>   <br/>  Outcome Assessment";
            GridView_CRF6_02.Caption = "<br/><br/>    <h4>Live Births";
            GridView_CRF6_03.Caption = "<br/><br/>    <h4>Cord Blood Collection Details";
            GridView_CRF6_04.Caption = "<br/><br/>    <h4>New born Capturing Details ";
            GridView_CRF6_05.Caption = "<br/><br/>    <h4>Place of Delivery live births ";
            GridView_CRF6_06.Caption = "<br/><br/>    <h4>Outcome Variables  Anthropometry (Cumulative)";
        }





        //CRF-6 Report:
        private void ExportReport_CRF6_01()
        {
            //Table_CRF6_01
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Total UNION  SELECT 'ARM-B' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-C' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-D' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'Cumulative',(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
                // MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-B' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-C' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'ARM-D' AS ARM,(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_18!='1'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4'  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION  SELECT 'Cumulative',(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Live_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='2' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Still_Birth, (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE   a.pw_crf_6a_21='3' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Miscarriage,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  a.pw_crf_6a_18!='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Not_Captured,			(SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE  STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_01.DataSource = dt;
                        GridView_CRF6_01.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }



        //CRF-6 Report:
        private void ExportReport_CRF6_02()
        {
            //Table_CRF6_02
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-B' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-C' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-D' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'Cumulative' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
               // MySqlCommand cmd = new MySqlCommand("SELECT 'ARM-A' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='1'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='1' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-B' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='2'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='2' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-C' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='3'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='3' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'ARM-D' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND e.pw_crf_3a_19='4'	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE b.pw_crf_3a_19='4' AND a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total UNION SELECT 'Cumulative' AS ARM,  (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) <37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'Pre-term < 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a 	LEFT JOIN studies AS b ON b.study_id=a.study_id		LEFT JOIN form_crf_3a AS e ON e.pw_id=b.pw_id LEFT JOIN (SELECT * FROM (SELECT b.form_crf_1_id,b.`pw_id`,b.`pw_assist_code`,	 DATE_SUB((STR_TO_DATE(b.pw_crf1_02, '%d-%m-%Y')), INTERVAL ((c.pw_crf_1_30_week*7)+c.pw_crf_1_30_days)  DAY) AS LMP  FROM form_crf_1 AS b LEFT JOIN ultrasound_examination AS c ON c.form_crf1_id=b.form_crf_1_id ) AS a WHERE a.form_crf_1_id IN (SELECT MIN(z.form_crf_1_id) FROM form_crf_1 AS z GROUP BY z.pw_assist_code)) AS f ON f.pw_id=b.pw_id 	WHERE 		CONCAT(SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)/7),'.',1)		,'.',    SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP)),'.',1)-SUBSTRING_INDEX(ABS(DATEDIFF(STR_TO_DATE(a.pw_crf_6a_19,'%d-%m-%Y'),f.LMP))/7,'.',1)*7) >=37.0	AND a.pw_crf_6a_21='1'	AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS 'On Term ≥ 37 weeks of gestational age', (SELECT COUNT(a.study_id) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.study_id=b.study_id WHERE a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') ) AS Total", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_02.DataSource = dt;
                        GridView_CRF6_02.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }

        //CRF-6 Report:
        private void ExportReport_CRF6_03()
        {
            //Table_CRF6_03
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.pw_id=b.pw_id LEFT JOIN lab_investigation AS c ON b.`pw_crf_3a_18`=c.`Randomization_ID` WHERE a.pw_crf_6a_21='1') AS 'Total Live Births',  (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.pw_id=b.pw_id LEFT JOIN lab_investigation AS c ON b.`pw_crf_3a_18`=c.`Randomization_ID` WHERE a.pw_crf_6a_21='1' AND c.`Description` !='') AS 'Total in Subsample', (SELECT COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_3a AS b ON a.pw_id=b.pw_id LEFT JOIN lab_investigation AS c ON b.`pw_crf_3a_18`=c.`Randomization_ID` WHERE a.pw_crf_6a_21='1' AND c.`Description` !='' AND c.`cord_blood_dt`!='') AS 'Cord Blood Collected'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_03.DataSource = dt;
                        GridView_CRF6_03.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }

        //CRF-6 Report:
        private void ExportReport_CRF6_04()
        {
            //Table_CRF6_04
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT	'0-5 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'6-12 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 6 AND 12)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=12)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'13-23 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 13 AND 23)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=23)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'24-48 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 24 AND 48)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=48)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'48-72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 49 AND 72)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=72)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'> 72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  >72 )  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage'", con);
                // MySqlCommand cmd = new MySqlCommand("SELECT	'0-5 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=5)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'6-12 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 6 AND 12) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 6 AND 12)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=12)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'13-23 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 13 AND 23) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 13 AND 23)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=23)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'24-48 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 24 AND 48) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 24 AND 48)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=48)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'48-72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') BETWEEN 49 AND 72) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  BETWEEN 49 AND 72)  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') <=72)  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage' UNION SELECT	'> 72 Hours', (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H') 	>72 ) AS n, ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND TIME_FORMAT(TIMEDIFF(CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_2`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_3`,' ',''),'%H:%i:%s')),CONCAT(STR_TO_DATE(`a`.`pw_crf_6a_19`,'%d-%m-%Y'),' ',TIME_FORMAT(REPLACE(`a`.`pw_crf_6a_20`,' ',''),'%H:%i:%s'))),'%H')  >72 )  /  (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Percentage', ROUND(((SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )  /   (SELECT COUNT(*) FROM form_crf_6a AS a WHERE 	a.pw_crf_6a_21='1' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')) * 100 ),1 ) AS 'Cumulative Percentage'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_04.DataSource = dt;
                        GridView_CRF6_04.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }

        //CRF-6 Report:
        private void ExportReport_CRF6_05()
        {
            //Table_CRF6_05
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'KGH' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'AKU Kharadar' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage'  UNION SELECT 'JPMC' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '3') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '3')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Civil' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '4') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '4')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Government Hospital' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '5:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '5:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Private Hospital' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Maternity Center' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '7:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '7:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Clinic' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '8:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '8:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Home' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1'  AND b.`pw_crf_6b_28` LIKE '10') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '10')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y') and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'On the way' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Other' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Don`t Know' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage'", con);
                // MySqlCommand cmd = new MySqlCommand("SELECT 'KGH' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '1')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'AKU Kharadar' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '2')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage'  UNION SELECT 'JPMC' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '3') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '3')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Civil' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '4') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '4')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Government Hospital' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '5:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '5:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Private Hospital' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '6:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Maternity Center' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '7:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '7:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Clinic' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '8:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '8:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Home' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1'  AND b.`pw_crf_6b_28` LIKE '10') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '10')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'On the way' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '11:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Other' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '12:%')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage' UNION SELECT 'Don`t Know' AS Facility, (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9') AS n, ROUND( ((SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1' AND b.`pw_crf_6b_28` LIKE '9')/ (SELECT  COUNT(*) FROM form_crf_6a AS a LEFT JOIN form_crf_6b AS b ON a.`study_id`=b.`study_id` WHERE STR_TO_DATE(pw_crf_6b_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') AND a.`pw_crf_6a_21`='1') * 100) ,1) AS 'Percentage'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_05.DataSource = dt;
                        GridView_CRF6_05.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }


        //CRF-6 Report:
        private void ExportReport_CRF6_06()
        {
            //Table_CRF6_06
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT 'Mean Birth Weight' AS FIELD,  ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Value' UNION SELECT 'Mean Birth Length' AS FIELD,  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y') between STR_TO_DATE('" + txtCalndrDate.Text + "','%d-%m-%Y')  and STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Value'", con);
                // MySqlCommand cmd = new MySqlCommand("SELECT 'Mean Birth Weight' AS FIELD,  ROUND(((SELECT SUM(a.`pw_crf_6a_26`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_26`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_26`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Value' UNION SELECT 'Mean Birth Length' AS FIELD,  ROUND(((SELECT SUM(a.`pw_crf_6a_28`) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_28`!='' AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y') )/ (SELECT COUNT(*) FROM form_crf_6a AS a WHERE a.`pw_crf_6a_28`!=''  AND STR_TO_DATE(a.pw_crf_6a_2,'%d-%m-%Y')<=STR_TO_DATE('" + txtCalndrDate1.Text + "','%d-%m-%Y')  )) ,1) AS 'Mean Value'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView_CRF6_06.DataSource = dt;
                        GridView_CRF6_06.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }





        //CRF-6  Report:
        public void ExcelExportReport_CRF6()
        {
            try
            {
                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;filename=CRF-6 Report (" + DateTime.Today.ToString("dd-MM-yyyy") + ").xls");
                Response.Charset = "";

                Response.ContentType = "application/vnd.xls";
                System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                System.Web.UI.HtmlTextWriter htmlWrite =
                new HtmlTextWriter(stringWrite);
                GridView_CRF6_01.AllowPaging = false;
                GridView_CRF6_02.AllowPaging = false;
                GridView_CRF6_03.AllowPaging = false;
                GridView_CRF6_04.AllowPaging = false;
                GridView_CRF6_05.AllowPaging = false;
                GridView_CRF6_06.AllowPaging = false;
                ExcelExportMessage_ReportCRF6();
                GridView_CRF6_01.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_02.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_03.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_04.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_05.CaptionAlign = TableCaptionAlign.Top;
                GridView_CRF6_06.CaptionAlign = TableCaptionAlign.Top;

                ExportReport_CRF6_01();
                ExportReport_CRF6_02();
                ExportReport_CRF6_03();
                ExportReport_CRF6_04();
                ExportReport_CRF6_05();
                ExportReport_CRF6_06();


                for (int i = 0; i < GridView_CRF6_01.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_01.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_02.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_02.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_03.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_03.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_04.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_04.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                for (int i = 0; i < GridView_CRF6_05.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_05.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_05.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_05.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_05.HeaderRow.Cells[i].Style.Add("Color", "white");
                }



                for (int i = 0; i < GridView_CRF6_06.HeaderRow.Cells.Count; i++)
                {
                    GridView_CRF6_06.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView_CRF6_06.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView_CRF6_06.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView_CRF6_06.HeaderRow.Cells[i].Style.Add("Color", "white");
                }


                GridView_CRF6_01.RenderControl(htmlWrite);
                GridView_CRF6_02.RenderControl(htmlWrite);
                GridView_CRF6_03.RenderControl(htmlWrite);
                GridView_CRF6_04.RenderControl(htmlWrite);
                GridView_CRF6_05.RenderControl(htmlWrite);
                GridView_CRF6_06.RenderControl(htmlWrite);


                Response.Write(stringWrite.ToString());
                Response.End();
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert(" + ex.Message + ")</script>");
            }
        }



    }
}